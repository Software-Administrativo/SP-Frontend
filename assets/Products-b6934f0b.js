import{v as R,x as z,_ as Pe,y as Ve,g as s,z as Oe,h as ae,f as xe,A as Ie,C as Se,r as v,o as A,c as te,a as d,d as o,w as r,i as c,q as G,M as Ce,l as oe,F as Ae,I as le,j as w,m as E,t as Ee,k as $,G as ne,B as se,p as Re,e as ze,J as De,T as re}from"./index-21ef78fb.js";import{B as Ne}from"./ButtonAdd-adf1e21d.js";const Ue=async l=>{try{const i=R(),{data:n}=await z.get("/inventory/product",{headers:{token:i,farm:l}});return n}catch(i){return i}},Be=async(l,i)=>{console.log("data send",l);try{const n=R(),{data:u}=await z.post("/inventory/product/register",{name:l.name,category:l.category,mark:l.mark,amount:l.amount,description:l.description},{headers:{token:n,farm:i}});return u}catch(n){return console.log(n),n}},Te=async(l,i)=>{try{const n=R(),{data:u}=await z.put(`/inventory/product/update/${l.id}`,{name:l.name,category:l.category,brand:l.brand,amount:l.amount,description:l.description},{headers:{token:n,farm:i}});return u}catch(n){return n}},Me=async(l,i)=>{try{const n=R(),{data:u}=await z.put(`/inventory/product/inactivate/${l}`,{},{headers:{token:n,farm:i}});return u}catch(n){return n}},Fe=async(l,i)=>{try{const n=R(),{data:u}=await z.put(`/inventory/product/activate/${l}`,{},{headers:{token:n,farm:i}});return u}catch(n){return n}};const J=l=>(Re("data-v-f8c7ba3c"),l=l(),ze(),l),je={class:"q-py-md table-container"},We={class:"row"},Ge=J(()=>d("h6",{class:"title q-my-lg"},"PRODUCTOS",-1)),$e={class:"container-content"},Je={class:"container-table q-mt-md q-pa-md",rounded:""},Le={class:"accions-td"},Qe={class:"accions-td"},He=J(()=>d("i",{class:"icon icon-check"},null,-1)),Ke={class:"modal-products"},Xe={class:"q-my-md text-center"},Ye={class:"row q-px-xl"},Ze={class:"col-12"},ea=J(()=>d("span",{class:"text-required q-pb-sm"},[E("Todos los campos con "),d("span",{class:"text-red"},"*"),E(" son obligatorios")],-1)),aa={class:"row justify-center"},ta={key:0,class:"spinner"},oa={__name:"Products",setup(l){const i=Ve(),n=s(""),u=s(!1),N=s(!0),V=s([]),x=s([]),L=s(),ue=Oe(),O=s(!1),Q=ae(()=>!g.value||!y.value||!p.value||!b.value?!0:O.value==!0),I=[e=>!!e||"Este campo es requerido"];let f=s(""),g=s(""),p=s(""),_=s(""),b=s(""),y=s(""),U=s(""),B=s(""),T=s(""),M=s(""),F=s(""),P=s("active");const ce=xe(),H=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"mark",label:"Marca",field:"mark",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"amount",label:"Cantidad",field:"amount",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),ie=e=>{g.value=e},de=e=>{p.value=e},ve=e=>{_.value=e},pe=e=>{y.value=e},me=e=>{b.value=e},fe=()=>{n.value="REGISTRAR PRODUCTOS",U.value="",B.value="",T.value="",M.value="",F.value="",N.value=!0,i.toggleModal(),g.value="",y.value="",p.value="",_.value="",b.value=""},ge=e=>{n.value="EDITAR PRODUCTOS",N.value=!1,L.value=e._id,U.value=e.name,B.value=e.mark,T.value=e.category,M.value=e.amount,F.value=e.description,g.value=e.name,y.value=e.description,p.value=e.brand,_.value=e.category,b.value=e.amount,i.toggleModal()},q=(e,t)=>{ce.notify({type:e,message:t,position:"top"})},S=async()=>{V.value=[],x.value=[],u.value=!0;try{const{product:e}=await Ue(k.value),{mark:t}=await le(k.value);let C=1,h=1;e.forEach(m=>{m.status=m.status?"Inactivo":"Activo",m.mark=t.find(D=>D._id==m.mark).name,m.status=="Activo"?(m.id=C++,V.value.push(m)):(m.id=h++,x.value.push(m))}),u.value=!1}catch{u.value=!1,q("negative","Ocurrió un error")}};async function _e(){const{category:e}=await De(k.value),{mark:t}=await le(k.value);e.forEach(h=>{h.name==_.value&&(_.value=h._id)}),t.forEach(h=>{h.name==p.value&&(p.value=h._id)}),O.value=!0,(await Be({name:g.value,mark:p.value,category:_.value,amount:b.value,description:y.value==""?"No registra":y.value},k.value)).msg!=re.ERROROPERATION?(O.value=!1,q("positive","Producto registrado correctamente"),i.toggleModal(),V.value=[],S()):(O.value=!1,q("negative","Ocurrió un error"))}async function be(){O.value=!0;const e=await Te({id:L.value,name:g.value,brand:p.value,amount:b.value},k.value);O.value=!1,e.msg!=re.ERROROPERATION?(q("positive","Producto actualizado correctamente"),i.toggleModal(),V.value=[],S()):q("negative","Ocurrió un error")}async function ye(e){u.value=!0;try{const t=await Fe(e,k.value);u.value=!1,q("positive","Producto activado correctamente"),V.value=[],x.value=[],S()}catch{u.value=!1,q("negative","Ocurrió un error")}}async function he(e){u.value=!0;try{const t=await Me(e,k.value);u.value=!1,q("positive","Producto desactivado correctamente"),V.value=[],x.value=[],S()}catch{u.value=!1,q("negative","Ocurrió un error")}}const k=ae(()=>ue.idSelected);return Ie(k,()=>{getDataUsers()}),Se(()=>{S()}),(e,t)=>{const C=v("q-separator"),h=v("q-tab"),m=v("q-tabs"),D=v("q-icon"),K=v("q-input"),j=v("q-tooltip"),W=v("q-btn"),X=v("q-btn-group"),Y=v("q-table"),Z=v("q-tab-panel"),qe=v("q-tab-panels"),ke=v("q-card"),we=v("q-spinner-ios");return A(),te(Ae,null,[d("div",je,[d("div",We,[d("i",{class:"icon icon-backRoute q-pt-lg",onClick:t[0]||(t[0]=a=>e.$router.back())}),Ge]),o(C,{class:"separator"}),d("div",$e,[o(Ne,{onOnClick:fe,label:"Crear nuevo producto"}),d("div",Je,[o(ke,null,{default:r(()=>[o(m,{modelValue:c(P),"onUpdate:modelValue":t[1]||(t[1]=a=>w(P)?P.value=a:P=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[o(h,{name:"active",label:"Activos"}),o(h,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),o(C),o(qe,{modelValue:c(P),"onUpdate:modelValue":t[4]||(t[4]=a=>w(P)?P.value=a:P=a),animated:""},{default:r(()=>[o(Z,{name:"active"},{default:r(()=>[o(Y,{flat:"",bordered:"",title:"Productos","row-key":"name",rows:V.value,columns:H.value,filter:c(f),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[o(K,{borderless:"",dense:"",debounce:"300",modelValue:c(f),"onUpdate:modelValue":t[2]||(t[2]=a=>w(f)?f.value=a:f=a),placeholder:"Search"},{append:r(()=>[o(D,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(a=>[d("td",Le,[o(X,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[o(W,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:ee=>ge(a.row)},{default:r(()=>[o(j,{class:"bg-indigo",offset:[10,10]},{default:r(()=>[E(" Editar ")]),_:1})]),_:2},1032,["onClick"]),o(W,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:ee=>he(a.row._id)},{default:r(()=>[o(j,{class:"bg-indigo",offset:[10,10]},{default:r(()=>[E(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),o(Z,{name:"inactive"},{default:r(()=>[o(Y,{flat:"",bordered:"",title:"Productos","row-key":"name",rows:x.value,columns:H.value,filter:c(f),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[o(K,{borderless:"",dense:"",debounce:"300",modelValue:c(f),"onUpdate:modelValue":t[3]||(t[3]=a=>w(f)?f.value=a:f=a),placeholder:"Search"},{append:r(()=>[o(D,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(a=>[d("td",Qe,[o(X,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[o(W,{"text-color":"blue-10",class:"col q-pa-none",onClick:ee=>ye(a.row._id)},{default:r(()=>[He,o(j,{class:"bg-indigo",offset:[10,10]},{default:r(()=>[E(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(i).modalIsOpen?(A(),G(Ce,{key:0,class:"modal"},{default:r(()=>[d("div",Ke,[d("h6",Xe,Ee(n.value),1),d("div",Ye,[d("div",Ze,[o($,{label:"Nombre",required:!0,type:"text",ruless:I,value:c(U),modelValue:c(g),"onUpdate:modelValue":t[5]||(t[5]=a=>w(g)?g.value=a:g=a),onOnWrite:ie},null,8,["value","modelValue"]),o(ne,{class:"q-pb-lg",label:"Marca",required:!0,type:"mark",ruless:I,value:c(B),modelValue:c(p),"onUpdate:modelValue":t[6]||(t[6]=a=>w(p)?p.value=a:p=a),onOnSelect:de},null,8,["value","modelValue"]),o(ne,{class:"q-pb-lg",label:"Categoria",required:!0,type:"category",ruless:I,value:c(T),modelValue:c(_),"onUpdate:modelValue":t[7]||(t[7]=a=>w(_)?_.value=a:_=a),onOnSelect:ve},null,8,["value","modelValue"]),o($,{class:"q-pb-xs",label:"Cantidad",required:!0,type:"number",ruless:I,value:c(M),modelValue:c(b),"onUpdate:modelValue":t[8]||(t[8]=a=>w(b)?b.value=a:b=a),onOnWrite:me},null,8,["value","modelValue"]),o($,{label:"Descripción",required:!0,ruless:I,type:"text",value:c(F),modelValue:c(y),"onUpdate:modelValue":t[9]||(t[9]=a=>w(y)?y.value=a:y=a),onOnWrite:pe},null,8,["value","modelValue"]),ea,d("div",aa,[N.value?(A(),G(se,{key:0,disable:c(Q),onOnClick:_e},null,8,["disable"])):(A(),G(se,{key:1,disable:c(Q),onOnClick:be},null,8,["disable"]))]),O.value?(A(),te("div",ta,[o(we,{color:"primary",size:"2.5em"})])):oe("",!0)])])])]),_:1})):oe("",!0)],64)}}},sa=Pe(oa,[["__scopeId","data-v-f8c7ba3c"]]);export{sa as default};
