import{g as ue,p as de,u as ve,a as me,i as pe}from"./index-c6e42169.js";import{B as fe}from"./ButtonAdd-246475aa.js";import{_ as _e,q as be,g as n,f as ge,m as qe,y as ye,r as i,o as F,c as H,a as s,d as e,w as o,h as r,i as B,M as he,j as J,F as we,z as q,A as V,t as Fe,B as U,C as K,p as Ve,e as ke}from"./index-2fcec7ed.js";const R=k=>(Ve("data-v-555bc476"),k=k(),ke(),k),xe={class:"q-py-md table-container"},Ae={class:"row"},Ie=R(()=>s("h6",{class:"title q-my-lg"},"FINCA",-1)),Ce={class:"container-content"},Se={class:"container-table q-mt-md q-pa-md",rounded:""},Oe={class:"accions-td"},ze={class:"accions-td"},Ne=R(()=>s("i",{class:"icon icon-check"},null,-1)),Me={class:"modal-farm"},Be={class:"q-my-md text-center"},Ue={class:"row q-px-xl"},Re={class:"col-12"},De=R(()=>s("span",{class:"text-required q-pb-sm"},[V("Todos los campos con "),s("span",{class:"text-red"},"*"),V(" son obligatorios")],-1)),Ee={class:"row justify-center"},Te={key:0,class:"spinner"},je={__name:"Farm",setup(k){const y=be(),A=n(""),c=n(!1),I=n(!0),_=n(!1),g=n([]),h=n([]),D=n(),E=ge(()=>u.value==""||d.value==""||v.value==""?!0:_.value==!0),C=[a=>!!a||"Este campo es requerido"];let m=n(""),u=n(""),d=n(""),v=n(""),S=n(""),O=n(""),z=n(""),b=n("active");const X=qe(),T=n([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"address",label:"Ubicación",field:"address",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"owner",label:"Propietario",field:"owner",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Y=a=>{u.value=a},Z=a=>{d.value=a},$=a=>{v.value=a},ee=()=>{A.value="REGISTRAR FINCA",S.value="",O.value="",z.value="",I.value=!0,y.toggleModal(),u.value="",d.value="",v.value=""},ae=a=>{A.value="EDITAR FINCA",I.value=!1,D.value=a._id,S.value=a.name,O.value=a.address,z.value=a.owner,u.value=a.name,d.value=a.address,v.value=a.owner,y.toggleModal()},f=(a,l)=>{X.notify({type:a,message:l,position:"top"})};async function w(){g.value=[],h.value=[],c.value=!0;try{const{farms:a}=await ue();let l=1,x=1;a.forEach(p=>{p.status=p.status?"Inactivo":"Activo",p.status=="Activo"?(p.id=l++,g.value.push(p)):(p.id=x++,h.value.push(p))}),c.value=!1}catch{c.value=!1,f("negative","Ocurrió un error")}}async function te(){_.value=!0;try{const a=await de({name:u.value,address:d.value,owner:v.value});_.value=!1,y.toggleModal(),f("positive","Finca registrada correctamente"),g.value=[],w()}catch{_.value=!1,f("negative","Ocurrió un error")}}async function le(){_.value=!0;try{const a=await ve({id:D.value,name:u.value,address:d.value,owner:v.value});_.value=!1,f("positive","Finca actualizada correctamente"),y.toggleModal(),g.value=[],w()}catch{_.value=!1,f("negative","Ocurrió un error")}u.value="",d.value="",v.value=""}async function oe(a){c.value=!0;try{const l=await me(a);c.value=!1,f("positive","Finca activada correctamente"),g.value=[],h.value=[],w()}catch{c.value=!1,f("negative","Ocurrió un error")}}async function ne(a){c.value=!0;try{const l=await pe(a);c.value=!1,f("positive","Finca desactivada correctamente"),g.value=[],h.value=[],w()}catch{c.value=!1,f("negative","Ocurrió un error")}}return ye(()=>{w()}),(a,l)=>{const x=i("q-separator"),p=i("q-tab"),se=i("q-tabs"),j=i("q-icon"),W=i("q-input"),N=i("q-tooltip"),M=i("q-btn"),P=i("q-btn-group"),G=i("q-table"),L=i("q-tab-panel"),re=i("q-tab-panels"),ie=i("q-card"),ce=i("q-spinner-ios");return F(),H(we,null,[s("div",xe,[s("div",Ae,[s("i",{class:"icon icon-backRoute q-pt-lg",onClick:l[0]||(l[0]=t=>a.$router.back())}),Ie]),e(x,{class:"separator"}),s("div",Ce,[e(fe,{onOnClick:ee,label:"Crear nueva finca"}),s("div",Se,[e(ie,null,{default:o(()=>[e(se,{modelValue:r(b),"onUpdate:modelValue":l[1]||(l[1]=t=>q(b)?b.value=t:b=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:o(()=>[e(p,{name:"active",label:"Activos"}),e(p,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(x),e(re,{modelValue:r(b),"onUpdate:modelValue":l[4]||(l[4]=t=>q(b)?b.value=t:b=t),animated:""},{default:o(()=>[e(L,{name:"active"},{default:o(()=>[e(G,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:g.value,columns:T.value,filter:r(m),loading:c.value,"rows-per-page-options":[5,10,20]},{"top-right":o(()=>[e(W,{borderless:"",dense:"",debounce:"300",modelValue:r(m),"onUpdate:modelValue":l[2]||(l[2]=t=>q(m)?m.value=t:m=t),placeholder:"Search"},{append:o(()=>[e(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":o(t=>[s("td",Oe,[e(P,{class:"full-width full-height",outline:"",square:""},{default:o(()=>[e(M,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:Q=>ae(t.row)},{default:o(()=>[e(N,{class:"bg-indigo",offset:[10,10]},{default:o(()=>[V(" Editar ")]),_:1})]),_:2},1032,["onClick"]),e(M,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:Q=>ne(t.row._id)},{default:o(()=>[e(N,{class:"bg-indigo",offset:[10,10]},{default:o(()=>[V(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(L,{name:"inactive"},{default:o(()=>[e(G,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:h.value,columns:T.value,filter:r(m),loading:c.value,"rows-per-page-options":[5,10,20]},{"top-right":o(()=>[e(W,{borderless:"",dense:"",debounce:"300",modelValue:r(m),"onUpdate:modelValue":l[3]||(l[3]=t=>q(m)?m.value=t:m=t),placeholder:"Search"},{append:o(()=>[e(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":o(t=>[s("td",ze,[e(P,{class:"full-width full-height",outline:"",square:""},{default:o(()=>[e(M,{"text-color":"blue-10",class:"col q-pa-none",onClick:Q=>oe(t.row._id)},{default:o(()=>[Ne,e(N,{class:"bg-indigo",offset:[10,10]},{default:o(()=>[V(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),r(y).modalIsOpen?(F(),B(he,{key:0,class:"modal"},{default:o(()=>[s("div",Me,[s("h6",Be,Fe(A.value),1),s("div",Ue,[s("div",Re,[e(U,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:C,value:r(S),modelValue:r(u),"onUpdate:modelValue":l[5]||(l[5]=t=>q(u)?u.value=t:u=t),onOnWrite:Y},null,8,["value","modelValue"]),e(U,{class:"q-pb-xs",label:"Ubicación",type:"text",required:!0,ruless:C,value:r(O),modelValue:r(d),"onUpdate:modelValue":l[6]||(l[6]=t=>q(d)?d.value=t:d=t),onOnWrite:Z},null,8,["value","modelValue"]),e(U,{class:"q-pb-xs",label:"Propietario",required:!0,type:"text",ruless:C,value:r(z),modelValue:r(v),"onUpdate:modelValue":l[7]||(l[7]=t=>q(v)?v.value=t:v=t),onOnWrite:$},null,8,["value","modelValue"]),De,s("div",Ee,[I.value?(F(),B(K,{key:0,disable:r(E),onOnClick:te},null,8,["disable"])):(F(),B(K,{key:1,disable:r(E),onOnClick:le},null,8,["disable"]))]),_.value?(F(),H("div",Te,[e(ce,{color:"primary",size:"2.5em"})])):J("",!0)])])])]),_:1})):J("",!0)],64)}}},Le=_e(je,[["__scopeId","data-v-555bc476"]]);export{Le as default};
