import{_ as be,m as he,q as qe,g as s,v as ye,f as Y,x as Ce,y as we,r,o as x,c as Z,a as u,d as l,w as o,h as i,i as F,M as Ve,j as $,F as ke,a0 as xe,z as q,A as S,t as Se,B as N,C as ee,p as Ie,e as Ee,a1 as Ne,R as ae,a2 as Ae,a3 as Oe,a4 as ze}from"./index-751a0b5d.js";import{B as De}from"./ButtonAdd-426bdcc1.js";const L=I=>(Ie("data-v-7a164a6d"),I=I(),Ee(),I),Me={class:"q-py-sm table-container"},Te={class:"row"},Ue=L(()=>u("h6",{class:"title q-my-lg"},"Clientes",-1)),Be={class:"container-content"},Re={class:"container-table q-mt-md q-pa-md",rounded:""},Fe={class:"accions-td"},Le={class:"accions-td"},We=L(()=>u("i",{class:"icon icon-check"},null,-1)),je={class:"modal-eps"},Ge={class:"q-my-md text-center"},Pe={class:"row q-px-xl"},He={class:"col-12"},Qe=L(()=>u("span",{class:"text-required q-pb-sm"},[S("Todos los campos con "),u("span",{class:"text-red"},"*"),S(" son obligatorios")],-1)),Je={class:"row justify-center"},Ke={key:0,class:"spinner"},Xe={__name:"Clients",setup(I){const te=he(),V=qe(),A=s(""),c=s(!1),O=s(!0),y=s([]),k=s([]),W=s(),le=ye(),b=s(!1),j=Y(()=>d.value==""||v.value==""||p.value==""||f.value==""?!0:b.value==!0),E=[e=>!!e||"Este campo es requerido"];let _=s(""),h=s("active"),d=s(""),v=s(""),p=s(""),f=s(""),z=s(""),D=s(""),M=s(""),T=s("");const G=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"document",label:"N° Documento",field:"document",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"phone",label:"Teléfono",field:"phone",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"address",label:"Dirección",field:"address",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),oe=e=>{d.value=e},ne=e=>{v.value=e},se=e=>{p.value=e},ie=e=>{f.value=e},ue=()=>{A.value="REGISTRAR CLIENTE",re(),O.value=!0,V.toggleModal()},re=()=>{z.value="",D.value="",M.value="",T.value="",d.value="",v.value="",p.value="",f.value=""},ce=e=>{A.value="EDITAR CLIENTE",O.value=!1,W.value=e._id,z.value=e.name,D.value=e.phone,M.value=e.document,T.value=e.address,d.value=e.name,v.value=e.phone,p.value=e.document,f.value=e.address,V.toggleModal()},m=(e,a)=>{te.notify({type:e,message:a,position:"top"})},C=async()=>{y.value=[],k.value=[],c.value=!0;try{const{client:e}=await xe(w.value);let a=1,g=1;e.forEach(n=>{n.status=n.status?"Inactivo":"Activo",n.status=="Activo"?(n.id=a++,y.value.push(n)):(n.id=g++,k.value.push(n))}),c.value=!1}catch{c.value=!1,m("negative","Ocurrió un error")}};async function de(){var e,a,g;b.value=!0;try{const n=await Ne({name:d.value,phone:v.value,document:p.value,address:f.value},w.value);b.value=!1,((g=(a=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:a.errors[0])==null?void 0:g.msg)==ae.LENGHTDOCUMENT?m("negative","El documento es muy corto"):(m("positive","Cliente registrado correctamente"),V.toggleModal(),y.value=[],C())}catch{b.value=!1,m("negative","Ocurrió un error, por favor verifique los datos")}}async function ve(){var e,a,g;b.value=!0;try{const n=await Ae({id:W.value,name:d.value,phone:v.value,document:p.value,address:f.value},w.value);b.value=!1,((g=(a=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:a.errors[0])==null?void 0:g.msg)==ae.LENGHTDOCUMENT?m("negative","El documento es muy corto"):(m("positive","Cliente actualizado correctamente"),V.toggleModal(),y.value=[],C())}catch{b.value=!1,m("negative","Ocurrió un error, por favor verifique los datos")}d.value="",v.value="",p.value="",f.value=""}async function pe(e){c.value=!0;try{await Oe(e,w.value),m("positive","Cliente activado correctamente"),c.value=!1,y.value=[],k.value=[],C()}catch{c.value=!1,m("negative","Ocurrió un error")}}async function fe(e){c.value=!1;try{await ze(e,w.value),c.value=!1,m("positive","Cliente desactivado correctamente"),y.value=[],k.value=[],C()}catch{c.value=!1,m("negative","Ocurrió un error")}}const w=Y(()=>le.idSelected);return Ce(w,()=>{C()}),we(()=>{C()}),(e,a)=>{const g=r("q-separator"),n=r("q-tab"),U=r("q-tabs"),P=r("q-icon"),H=r("q-input"),B=r("q-tooltip"),R=r("q-btn"),Q=r("q-btn-group"),J=r("q-table"),K=r("q-tab-panel"),me=r("q-tab-panels"),_e=r("q-card"),ge=r("q-spinner-ios");return x(),Z(ke,null,[u("div",Me,[u("div",Te,[u("i",{class:"icon icon-backRoute q-pt-lg",onClick:a[0]||(a[0]=t=>e.$router.back())}),Ue]),l(g,{class:"separator"}),u("div",Be,[l(De,{onOnClick:ue,label:"Crear nuevo cliente"}),u("div",Re,[l(_e,null,{default:o(()=>[l(U,{modelValue:i(h),"onUpdate:modelValue":a[1]||(a[1]=t=>q(h)?h.value=t:h=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:o(()=>[l(n,{name:"active",label:"Activos"}),l(n,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(g),l(me,{modelValue:i(h),"onUpdate:modelValue":a[4]||(a[4]=t=>q(h)?h.value=t:h=t),animated:""},{default:o(()=>[l(K,{name:"active"},{default:o(()=>[l(J,{flat:"",bordered:"",title:"Clientes","row-key":"name",rows:y.value,columns:G.value,filter:i(_),loading:c.value,"rows-per-page-options":[5,10,20]},{"top-right":o(()=>[l(H,{borderless:"",dense:"",debounce:"300",modelValue:i(_),"onUpdate:modelValue":a[2]||(a[2]=t=>q(_)?_.value=t:_=t),placeholder:"Search"},{append:o(()=>[l(P,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":o(t=>[u("td",Fe,[l(Q,{class:"full-width full-height",outline:"",square:""},{default:o(()=>[l(R,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:X=>ce(t.row)},{default:o(()=>[l(B,{class:"bg-indigo",offset:[10,10]},{default:o(()=>[S(" Editar ")]),_:1})]),_:2},1032,["onClick"]),l(R,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:X=>fe(t.row._id)},{default:o(()=>[l(B,{class:"bg-indigo",offset:[10,10]},{default:o(()=>[S(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(K,{name:"inactive"},{default:o(()=>[l(J,{flat:"",bordered:"",title:"Clientes","row-key":"name",rows:k.value,columns:G.value,filter:i(_),loading:c.value,"rows-per-page-options":[5,10,20]},{"top-right":o(()=>[l(H,{borderless:"",dense:"",debounce:"300",modelValue:i(_),"onUpdate:modelValue":a[3]||(a[3]=t=>q(_)?_.value=t:_=t),placeholder:"Search"},{append:o(()=>[l(P,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":o(t=>[u("td",Le,[l(Q,{class:"full-width full-height",outline:"",square:""},{default:o(()=>[l(R,{"text-color":"blue-10",class:"col q-pa-none",onClick:X=>pe(t.row._id)},{default:o(()=>[We,l(B,{class:"bg-indigo",offset:[10,10]},{default:o(()=>[S(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(V).modalIsOpen?(x(),F(Ve,{key:0,class:"modal"},{default:o(()=>[u("div",je,[u("h6",Ge,Se(A.value),1),u("div",Pe,[u("div",He,[l(N,{label:"Nombre",required:!0,type:"text",ruless:E,value:i(z),modelValue:i(d),"onUpdate:modelValue":a[5]||(a[5]=t=>q(d)?d.value=t:d=t),onOnWrite:oe},null,8,["value","modelValue"]),l(N,{class:"q-mb-md",required:!0,label:"Teléfono",type:"text",ruless:E,value:i(D),modelValue:i(v),"onUpdate:modelValue":a[6]||(a[6]=t=>q(v)?v.value=t:v=t),onOnWrite:ne},null,8,["value","modelValue"]),l(N,{class:"q-pb-xs",label:"N° Documento",required:!0,type:"text",ruless:E,value:i(M),modelValue:i(p),"onUpdate:modelValue":a[7]||(a[7]=t=>q(p)?p.value=t:p=t),onOnWrite:se},null,8,["value","modelValue"]),l(N,{class:"q-pb-xs",label:"Dirección",required:!0,type:"text",ruless:E,value:i(T),modelValue:i(f),"onUpdate:modelValue":a[8]||(a[8]=t=>q(f)?f.value=t:f=t),onOnWrite:ie},null,8,["value","modelValue"]),Qe,u("div",Je,[O.value?(x(),F(ee,{key:0,disable:i(j),onOnClick:de},null,8,["disable"])):(x(),F(ee,{key:1,disable:i(j),onOnClick:ve},null,8,["disable"]))]),b.value?(x(),Z("div",Ke,[l(ge,{color:"primary",size:"2.5em"})])):$("",!0)])])])]),_:1})):$("",!0)],64)}}},$e=be(Xe,[["__scopeId","data-v-7a164a6d"]]);export{$e as default};
