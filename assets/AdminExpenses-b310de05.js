import{v as z,x as T,_ as ye,f as we,y as xe,g as r,z as qe,h as te,A as Ae,C as ke,r as d,o as C,c as ae,a as c,d as t,w as l,i,q as j,M as Ee,l as oe,F as Ve,E as L,j as k,m as O,t as Se,k as Q,G as Ie,B as se,p as Ce,e as Oe}from"./index-21ef78fb.js";import{B as ze}from"./ButtonAdd-adf1e21d.js";const Te=async n=>{try{const u=z(),{data:s}=await T.get("/costs/adminexpenses",{headers:{token:u,farm:n}});return s}catch(u){return u}},De=async(n,u)=>{try{const s=z(),{data:v}=await T.post("/costs/adminexpenses/register",{name:n.name,description:n.description,worth:n.worth,spent:n.spent},{headers:{token:s,farm:u}});return v}catch(s){return s}},Ge=async(n,u)=>{try{const s=z(),{data:v}=await T.put(`/costs/adminexpenses/update/${n.id}`,{name:n.name,description:n.description,worth:n.worth,spent:n.spent},{headers:{token:s,farm:u}});return v}catch(s){return s}},Ne=async(n,u)=>{try{const s=z(),{data:v}=await T.put(`/costs/adminexpenses/inactivate/${n}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}},Me=async(n,u)=>{try{const s=z(),{data:v}=await T.put(`/costs/adminexpenses/activate/${n}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}};const H=n=>(Ce("data-v-39d6c5bd"),n=n(),Oe(),n),Be={class:"q-py-sm table-container"},Re={class:"row"},Ue=H(()=>c("h6",{class:"title q-my-lg"},"Gastos Administrativos",-1)),Fe={class:"container-content"},We={class:"container-table q-mt-md q-pa-md",rounded:""},$e={class:"accions-td"},je={class:"accions-td"},Le=H(()=>c("i",{class:"icon icon-check"},null,-1)),Qe={class:"modal-admin"},He={class:"q-my-md text-center"},Je={class:"row q-px-xl"},Ke={class:"col-12"},Pe=H(()=>c("span",{class:"text-required q-pb-sm"},[O("Todos los campos con "),c("span",{class:"text-red"},"*"),O(" son obligatorios")],-1)),Xe={class:"row justify-center"},Ye={key:0,class:"spinner"},Ze={__name:"AdminExpenses",setup(n){const u=we(),s=xe(),v=r(""),p=r(!1),M=r(!0),A=r([]),S=r([]),J=r(),ne=qe(),x=r(!1),K=te(()=>m.value==""||_.value==""||f.value==""?!0:x.value==!0),D=[e=>!!e||"Este campo es requerido"];let b=r(""),q=r("active"),m=r(""),f=r(""),_=r(""),h=r(""),B=r(""),R=r(""),U=r(""),F=r("");const P=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"spent",label:"Tipo de gasto",field:"spent",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"worth",label:"Valor",field:"worth",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),le=e=>{m.value=e},re=e=>{f.value=e},ie=e=>{_.value=e},ce=e=>{h.value=e},ue=()=>{v.value="REGISTRAR GASTO ADMINISTRATIVO",de(),M.value=!0,s.toggleModal()},de=()=>{R.value="",U.value="",F.value="",m.value="",f.value="",_.value="",B.value="",h.value=""},ve=e=>{v.value="EDITAR GASTO ADMINISTRATIVO",M.value=!1,J.value=e._id,R.value=e.name,U.value=e.description,h.value=e.spent,F.value=e.worth,m.value=e.name,f.value=e.description,_.value=e.worth,B.value=e.spent,s.toggleModal()},y=(e,a)=>{u.notify({type:e,message:a,position:"top"})},E=async()=>{A.value=[],S.value=[],p.value=!0;try{const{adminExpenses:e}=await Te(w.value),{spents:a}=await L(w.value);let G=1,N=1;e.forEach(g=>{g.status=g.status?"Inactivo":"Activo";let V=g.spent._id;a.forEach(I=>{I._id==V&&(V=I.name)}),g.spent=V,g.status=="Activo"?(g.id=G++,A.value.push(g)):(g.id=N++,S.value.push(g))}),p.value=!1}catch{p.value=!1,y("negative","Ocurrió un error")}};async function pe(){x.value=!0;const{spents:e}=await L(w.value);e.forEach(a=>{a.name==h.value&&(h.value=a._id)});try{await De({name:m.value,description:f.value,worth:_.value,spent:h.value},w.value),x.value=!1,y("positive","Gasto administrativo registrado correctamente"),s.toggleModal(),A.value=[],E()}catch{x.value=!1,y("negative","Ocurrió un error, por favor verifique los datos")}}async function me(){x.value=!0;const{spents:e}=await L(w.value);e.forEach(a=>{a.name==h.value&&(h.value=a._id)});try{await Ge({id:J.value,name:m.value,description:f.value,worth:_.value,spent:h.value},w.value),x.value=!1,y("positive","Gasto administrativo actualizado correctamente"),s.toggleModal(),A.value=[],E()}catch{x.value=!1,y("negative","Ocurrió un error, por favor verifique los datos")}m.value="",f.value="",_.value=""}async function fe(e){p.value=!0;try{await Me(e,w.value),y("positive","Gasto administrativo activado correctamente"),p.value=!1,A.value=[],S.value=[],E()}catch{p.value=!1,y("negative","Ocurrió un error")}}async function _e(e){p.value=!1;try{await Ne(e,w.value),p.value=!1,y("positive","Gasto administrativo desactivado correctamente"),A.value=[],S.value=[],E()}catch{p.value=!1,y("negative","Ocurrió un error")}}const w=te(()=>ne.idSelected);return Ae(w,()=>{E()}),ke(()=>{E()}),(e,a)=>{const G=d("q-separator"),N=d("q-tab"),g=d("q-tabs"),V=d("q-icon"),I=d("q-input"),W=d("q-tooltip"),$=d("q-btn"),X=d("q-btn-group"),Y=d("q-table"),Z=d("q-tab-panel"),ge=d("q-tab-panels"),be=d("q-card"),he=d("q-spinner-ios");return C(),ae(Ve,null,[c("div",Be,[c("div",Re,[c("i",{class:"icon icon-backRoute q-pt-lg",onClick:a[0]||(a[0]=o=>e.$router.back())}),Ue]),t(G,{class:"separator"}),c("div",Fe,[t(ze,{onOnClick:ue,label:"Crear nuevo gasto administrativo"}),c("div",We,[t(be,null,{default:l(()=>[t(g,{modelValue:i(q),"onUpdate:modelValue":a[1]||(a[1]=o=>k(q)?q.value=o:q=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(N,{name:"active",label:"Activos"}),t(N,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(G),t(ge,{modelValue:i(q),"onUpdate:modelValue":a[4]||(a[4]=o=>k(q)?q.value=o:q=o),animated:""},{default:l(()=>[t(Z,{name:"active"},{default:l(()=>[t(Y,{flat:"",bordered:"",title:"Gastos Administrativos","row-key":"name",rows:A.value,columns:P.value,filter:i(b),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(I,{borderless:"",dense:"",debounce:"300",modelValue:i(b),"onUpdate:modelValue":a[2]||(a[2]=o=>k(b)?b.value=o:b=o),placeholder:"Search"},{append:l(()=>[t(V,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[c("td",$e,[t(X,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t($,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:ee=>ve(o.row)},{default:l(()=>[t(W,{class:"bg-indigo",offset:[10,10]},{default:l(()=>[O(" Editar ")]),_:1})]),_:2},1032,["onClick"]),t($,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:ee=>_e(o.row._id)},{default:l(()=>[t(W,{class:"bg-indigo",offset:[10,10]},{default:l(()=>[O(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(Z,{name:"inactive"},{default:l(()=>[t(Y,{flat:"",bordered:"",title:"Gastos Administrativos","row-key":"name",rows:S.value,columns:P.value,filter:i(b),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(I,{borderless:"",dense:"",debounce:"300",modelValue:i(b),"onUpdate:modelValue":a[3]||(a[3]=o=>k(b)?b.value=o:b=o),placeholder:"Search"},{append:l(()=>[t(V,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[c("td",je,[t(X,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t($,{"text-color":"blue-10",class:"col q-pa-none",onClick:ee=>fe(o.row._id)},{default:l(()=>[Le,t(W,{class:"bg-indigo",offset:[10,10]},{default:l(()=>[O(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(s).modalIsOpen?(C(),j(Ee,{key:0,class:"modal"},{default:l(()=>[c("div",Qe,[c("h6",He,Se(v.value),1),c("div",Je,[c("div",Ke,[t(Q,{label:"Nombre",required:!0,type:"text",ruless:D,value:i(R),modelValue:i(m),"onUpdate:modelValue":a[5]||(a[5]=o=>k(m)?m.value=o:m=o),onOnWrite:le},null,8,["value","modelValue"]),t(Ie,{class:"q-pb-md",onOnSelect:ce,type:"spent",required:!0,label:"Tipo de gasto",ruless:D,value:i(B)},null,8,["value"]),t(Q,{label:"Descripción",required:!0,type:"text",ruless:D,value:i(U),modelValue:i(f),"onUpdate:modelValue":a[6]||(a[6]=o=>k(f)?f.value=o:f=o),onOnWrite:re},null,8,["value","modelValue"]),t(Q,{class:"q-pb-xs",label:"Valor",required:!0,type:"text",ruless:D,value:i(F),modelValue:i(_),"onUpdate:modelValue":a[7]||(a[7]=o=>k(_)?_.value=o:_=o),onOnWrite:ie},null,8,["value","modelValue"]),Pe,c("div",Xe,[M.value?(C(),j(se,{key:0,disable:i(K),onOnClick:pe},null,8,["disable"])):(C(),j(se,{key:1,disable:i(K),onOnClick:me},null,8,["disable"]))]),x.value?(C(),ae("div",Ye,[t(he,{color:"primary",size:"2.5em"})])):oe("",!0)])])])]),_:1})):oe("",!0)],64)}}},at=ye(Ze,[["__scopeId","data-v-39d6c5bd"]]);export{at as default};
