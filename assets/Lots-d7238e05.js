import{_ as Ie,m as Ce,q as Ae,g as s,v as De,f as se,x as Ee,y as Ue,r as i,o as x,c as ne,a as u,d as l,w as n,h as o,i as E,M as Me,j as Q,F as Ne,D as Be,z as c,A as C,t as Te,B as U,E as M,C as ue,p as Re,e as Fe,X as We,Y as je,Z as He,$ as Je}from"./index-2fcec7ed.js";import{B as Ge}from"./ButtonAdd-246475aa.js";const X=A=>(Re("data-v-6cdebb4c"),A=A(),Fe(),A),Pe={class:"q-py-md table-container"},Qe={class:"row"},Xe=X(()=>u("h6",{class:"title q-my-lg"},"LOTES",-1)),Ye={class:"container-content"},Ze={class:"container-table q-mt-md q-pa-md",rounded:""},Ke={class:"accions-td"},$e={class:"accions-td"},ea=X(()=>u("i",{class:"icon icon-check"},null,-1)),aa={class:"modal-lots"},ta={class:"q-my-md text-center"},la={class:"row q-px-xl"},oa={class:"col-12"},sa=X(()=>u("span",{class:"text-required q-pb-sm"},[C("Todos los campos con "),u("span",{class:"text-red"},"*"),C(" son obligatorios")],-1)),na={class:"row justify-center"},ua={key:1,class:"spinner"},ra={__name:"Lots",setup(A){const re=Ce(),O=Ae(),N=s(""),v=s(!1),B=s(!0),w=s([]),I=s([]),Y=s(),ie=De(),h=s(!1),Z=se(()=>(f.value,m.value,g.value,b.value,d.value,_.value?h.value==!0:!0)),V=[e=>!!e||"Este campo es requerido"];let p=s(""),S=s("active"),f=s(""),m=s(""),g=s(""),b=s(""),d=s(""),_=s(""),y=s(""),L=s(""),T=s(""),R=s(""),F=s(""),W=s(""),j=s(""),H=s(""),J=s(""),de=s("");const K=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"areasize",label:"Tamaño",field:"areasize",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"soildstate",label:"Estado del suelo",field:"soildstate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"classlot",label:"Clase",field:"classlote",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"fatherlot",label:"Lote padre",field:"fatherlot",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"sowingdensity",label:"Densidad de siembra",field:"sowingdensity",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),ce=e=>{f.value=e},ve=e=>{m.value=e},pe=e=>{g.value=e},fe=e=>{b.value=e},me=e=>{d.value=e},ge=e=>{_.value=e},be=e=>{y.value=e},_e=e=>{L.value=e},ye=()=>{N.value="REGISTRAR LOTE",qe(),B.value=!0,O.toggleModal()},qe=()=>{T.value="",R.value="",F.value="",W.value="",j.value="",H.value="",J.value="",f.value="",m.value="",g.value="",b.value="",d.value="",_.value="",y.value=""},he=e=>{N.value="EDITAR LOTE",B.value=!1,Y.value=e._id,T.value=e.name,R.value=e.areasize,F.value=e.lotestate,W.value=e.soildstate,j.value=e.classlot,H.value=e.sowingdensity,J.value=e.description,f.value=e.name,m.value=e.areasize,g.value=e.lotestate,b.value=e.soildstate,d.value=e.classlot,_.value=e.sowingdensity,y.value=e.description,O.toggleModal()},q=(e,t)=>{re.notify({type:e,message:t,position:"top"})},z=async()=>{w.value=[],I.value=[],v.value=!0;try{const{lots:e}=await Be(k.value);let t=1,D=1;e.forEach(r=>{r.status=r.status?"Inactivo":"Activo",r.status=="Activo"?(r.id=t++,w.value.push(r)):(r.id=D++,I.value.push(r)),r.description=r.description.trim()==""?"No registra":r.description}),v.value=!1}catch{v.value=!1,q("negative","Ocurrió un error")}};async function Se(){h.value=!0;try{await We({name:f.value,areasize:m.value,lotestate:g.value,soildstate:b.value,classlote:d.value,fatherlot:L.value,sowingdensity:_.value,description:y.value},k.value),h.value=!1,q("positive","Lote registrado correctamente"),O.toggleModal(),w.value=[],z()}catch{h.value=!1,q("negative","Ocurrió un error, por favor verifique los datos")}}async function we(){h.value=!0;try{const e=await je({id:Y.value,name:f.value,areasize:m.value,lotestate:g.value,soildstate:b.value,classlot:d.value,fatherlot:fatherlot.value,sowingdensity:_.value,description:y.value},k.value);h.value=!1,q("positive","Lote actualizado correctamente"),O.toggleModal(),w.value=[],z()}catch{h.value=!1,q("negative","Ocurrió un error, por favor verifique los datos")}}async function Ve(e){v.value=!0;try{const t=await He(e,k.value);q("positive","Eps activada correctamente"),v.value=!1,w.value=[],I.value=[],z()}catch{v.value=!1,q("negative","Ocurrió un error")}}async function Le(e){try{const t=await Je(e,k.value);v.value=!1,q("positive","Eps desactivada correctamente"),w.value=[],I.value=[],z()}catch{v.value=!1,q("negative","Ocurrió un error")}}const k=se(()=>ie.idSelected);return Ee(k,()=>{z()}),Ue(()=>{z()}),(e,t)=>{const D=i("q-separator"),r=i("q-tab"),ze=i("q-tabs"),$=i("q-icon"),ee=i("q-input"),G=i("q-tooltip"),P=i("q-btn"),ae=i("q-btn-group"),te=i("q-table"),le=i("q-tab-panel"),ke=i("q-tab-panels"),xe=i("q-card"),Oe=i("q-spinner-ios");return x(),ne(Ne,null,[u("div",Pe,[u("div",Qe,[u("i",{class:"icon icon-backRoute q-pt-lg",onClick:t[0]||(t[0]=a=>e.$router.back())}),Xe]),l(D,{class:"separator"}),u("div",Ye,[l(Ge,{onOnClick:ye,label:"Crear nuevo lote"}),u("div",Ze,[l(xe,null,{default:n(()=>[l(ze,{modelValue:o(S),"onUpdate:modelValue":t[1]||(t[1]=a=>c(S)?S.value=a:S=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[l(r,{name:"active",label:"Activos"}),l(r,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(D),l(ke,{modelValue:o(S),"onUpdate:modelValue":t[4]||(t[4]=a=>c(S)?S.value=a:S=a),animated:""},{default:n(()=>[l(le,{name:"active"},{default:n(()=>[l(te,{flat:"",bordered:"",title:"Lotes","row-key":"name",rows:w.value,columns:K.value,filter:o(p),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[l(ee,{borderless:"",dense:"",debounce:"300",modelValue:o(p),"onUpdate:modelValue":t[2]||(t[2]=a=>c(p)?p.value=a:p=a),placeholder:"Search"},{append:n(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(a=>[u("td",Ke,[l(ae,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[l(P,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:oe=>he(a.row)},{default:n(()=>[l(G,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[C(" Editar ")]),_:1})]),_:2},1032,["onClick"]),l(P,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:oe=>Le(a.row._id)},{default:n(()=>[l(G,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[C(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(le,{name:"inactive"},{default:n(()=>[l(te,{flat:"",bordered:"",title:"Lotes","row-key":"name",rows:I.value,columns:K.value,filter:o(p),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[l(ee,{borderless:"",dense:"",debounce:"300",modelValue:o(p),"onUpdate:modelValue":t[3]||(t[3]=a=>c(p)?p.value=a:p=a),placeholder:"Search"},{append:n(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(a=>[u("td",$e,[l(ae,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[l(P,{"text-color":"blue-10",class:"col q-pa-none",onClick:oe=>Ve(a.row._id)},{default:n(()=>[ea,l(G,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[C(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),o(O).modalIsOpen?(x(),E(Me,{key:0,class:"modal"},{default:n(()=>[u("div",aa,[u("h6",ta,Te(N.value),1),u("div",la,[u("div",oa,[l(U,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:V,value:o(T),modelValue:o(f),"onUpdate:modelValue":t[5]||(t[5]=a=>c(f)?f.value=a:f=a),onOnWrite:ce},null,8,["value","modelValue"]),l(U,{class:"q-pb-xs",label:"Tamaño",type:"number",required:!0,ruless:V,value:o(R),modelValue:o(m),"onUpdate:modelValue":t[6]||(t[6]=a=>c(m)?m.value=a:m=a),onOnWrite:ve},null,8,["value","modelValue"]),l(M,{class:"q-pb-lg",label:"Estado del lote",type:"lotState",required:!0,ruless:V,value:o(F),modelValue:o(g),"onUpdate:modelValue":t[7]||(t[7]=a=>c(g)?g.value=a:g=a),onOnSelect:pe},null,8,["value","modelValue"]),l(M,{class:"q-pb-lg",label:"Estado del suelo",type:"soildState",required:!0,ruless:V,value:o(W),modelValue:o(b),"onUpdate:modelValue":t[8]||(t[8]=a=>c(b)?b.value=a:b=a),onOnSelect:fe},null,8,["value","modelValue"]),l(M,{class:"q-pb-lg",label:"Clase",type:"typeLot",required:!0,ruless:V,value:o(j),modelValue:o(d),"onUpdate:modelValue":t[9]||(t[9]=a=>c(d)?d.value=a:d=a),onOnSelect:me},null,8,["value","modelValue"]),o(d)=="HIJO"||o(d)=="PADRE-HIJO"?(x(),E(M,{key:0,class:"q-pb-lg",label:"Lote padre",type:"fatherLot",required:!0,ruless:V,value:o(de),modelValue:o(L),"onUpdate:modelValue":t[10]||(t[10]=a=>c(L)?L.value=a:L=a),onOnSelect:_e},null,8,["value","modelValue"])):Q("",!0),l(U,{class:"q-pb-xs",label:"Densidad de siembra",type:"number",required:!0,ruless:V,value:o(H),modelValue:o(_),"onUpdate:modelValue":t[11]||(t[11]=a=>c(_)?_.value=a:_=a),onOnWrite:ge},null,8,["value","modelValue"]),l(U,{class:"q-pb-xs",label:"Descripción",type:"text",required:!1,value:o(J),modelValue:o(y),"onUpdate:modelValue":t[12]||(t[12]=a=>c(y)?y.value=a:y=a),onOnWrite:be},null,8,["value","modelValue"]),sa,u("div",na,[B.value?(x(),E(ue,{key:0,disable:o(Z),onOnClick:Se},null,8,["disable"])):(x(),E(ue,{key:1,disable:o(Z),onOnClick:we},null,8,["disable"]))]),h.value?(x(),ne("div",ua,[l(Oe,{color:"primary",size:"2.5em"})])):Q("",!0)])])])]),_:1})):Q("",!0)],64)}}},ca=Ie(ra,[["__scopeId","data-v-6cdebb4c"]]);export{ca as default};
