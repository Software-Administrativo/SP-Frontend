import{v as A,x as D,_ as pe,f as me,y as fe,g as r,z as _e,h as J,A as ye,C as ge,r as u,o as x,c as K,a as i,d as e,w as s,i as d,q as O,M as be,l as P,F as he,j as U,m as V,t as qe,k as X,B as Y,p as we,e as ke}from"./index-f354315f.js";import{B as Ue}from"./ButtonAdd-9b531d6c.js";const Me=async l=>{try{const c=A(),{data:t}=await D.get("/maintenance/unittypes",{headers:{token:c,farm:l}});return t}catch(c){return c}},xe=async(l,c)=>{try{const t=A(),{data:v}=await D.post("/maintenance/unittypes/register",{name:l.name,unittype:l.unittype},{headers:{token:t,farm:c}});return v}catch(t){return t}},Ve=async(l,c)=>{try{const t=A(),{data:v}=await D.put(`/maintenance/unittypes/update/${l.id}`,{name:l.name,unittype:l.unittype},{headers:{token:t,farm:c}});return v}catch(t){return t}},Ae=async(l,c)=>{try{const t=A(),{data:v}=await D.put(`/maintenance/unittypes/inactive/${l}`,{},{headers:{token:t,farm:c}});return v}catch(t){return t}},De=async(l,c)=>{try{const t=A(),{data:v}=await D.put(`/maintenance/unittypes/active/${l}`,{},{headers:{token:t,farm:c}});return v}catch(t){return t}};const T=l=>(we("data-v-26939382"),l=l(),ke(),l),Ie={class:"q-py-md table-container"},Ee={class:"row"},Se=T(()=>i("h6",{class:"title q-my-lg"},"UNIDADES DE MEDIDA",-1)),Ce={class:"container-content"},Ne={class:"container-table q-mt-md q-pa-md",rounded:""},ze={class:"accions-td"},Oe={class:"accions-td"},Te=T(()=>i("i",{class:"icon icon-check"},null,-1)),Be={class:"modal-units"},Re={class:"q-my-md text-center"},Fe={class:"row q-px-xl"},$e={class:"col-12"},je=T(()=>i("span",{class:"text-required q-pb-sm"},[V("Todos los campos con "),i("span",{class:"text-red"},"*"),V(" son obligatorios")],-1)),We={class:"row justify-center"},Ge={key:0,class:"spinner"},Le={__name:"UnitsMeasurement",setup(l){const c=me(),t=fe(),v=r(""),p=r(!1),E=r(!0),q=r([]),M=r([]),B=r(),Z=_e(),b=r(!1),R=J(()=>m.value==""||f.value==""?!0:b.value==!0),F=[a=>!!a||"Este campo es requerido"];let _=r(""),h=r("active"),m=r(""),f=r(""),S=r(""),C=r("");const $=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"unittype",label:"Tipo de unidad",field:"unittype",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),ee=a=>{m.value=a},te=a=>{f.value=a},ae=()=>{v.value="REGISTRAR UNIDAD DE MEDIDA",ne(),E.value=!0,t.toggleModal()},ne=()=>{C.value="",S.value="",m.value="",f.value=""},oe=a=>{v.value="EDITAR UNIDAD DE MEDIDA",E.value=!1,B.value=a._id,C.value=a.unittype,S.value=a.name,m.value=a.name,f.value=a.unittype,t.toggleModal()},g=(a,o)=>{c.notify({type:a,message:o,position:"top"})},w=async()=>{q.value=[],M.value=[],p.value=!0;try{const{unitType:a}=await Me(k.value);let o=1,I=1;a.forEach(y=>{y.status=y.status?"Inactivo":"Activo",y.status=="Activo"?(y.id=o++,q.value.push(y)):(y.id=I++,M.value.push(y))}),p.value=!1}catch{p.value=!1,g("negative","Ocurrió un error")}};async function se(){b.value=!0;try{const a=await xe({name:m.value,unittype:f.value},k.value);b.value=!1,g("positive","Unidad de medidad registrada correctamente"),t.toggleModal(),q.value=[],w()}catch{b.value=!1,g("negative","Ocurrió un error, por favor verifique los datos")}}async function le(){b.value=!0;try{const a=await Ve({id:B.value,name:m.value,unittype:f.value},k.value);b.value=!1,g("positive","Unidad de medida actualizada correctamente"),t.toggleModal(),q.value=[],w()}catch{b.value=!1,g("negative","Ocurrió un error, por favor verifique los datos")}m.value="",f.value=""}async function ie(a){p.value=!0;try{const o=await De(a,k.value);g("positive","Unidad de medida activada correctamente"),p.value=!1,q.value=[],M.value=[],w()}catch{p.value=!1,g("negative","Ocurrió un error")}}async function re(a){p.value=!1;try{const o=await Ae(a,k.value);p.value=!1,g("positive","Unidad de medida desactivada correctamente"),q.value=[],M.value=[],w()}catch{p.value=!1,g("negative","Ocurrió un error")}}const k=J(()=>Z.idSelected);return ye(k,()=>{w()}),ge(()=>{w()}),(a,o)=>{const I=u("q-separator"),y=u("q-tab"),ce=u("q-tabs"),j=u("q-icon"),W=u("q-input"),N=u("q-tooltip"),z=u("q-btn"),G=u("q-btn-group"),L=u("q-table"),Q=u("q-tab-panel"),ue=u("q-tab-panels"),de=u("q-card"),ve=u("q-spinner-ios");return x(),K(he,null,[i("div",Ie,[i("div",Ee,[i("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=n=>a.$router.back())}),Se]),e(I,{class:"separator"}),i("div",Ce,[e(Ue,{onOnClick:ae,label:"Crear unidad de medida"}),i("div",Ne,[e(de,null,{default:s(()=>[e(ce,{modelValue:d(h),"onUpdate:modelValue":o[1]||(o[1]=n=>U(h)?h.value=n:h=n),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:s(()=>[e(y,{name:"active",label:"Activos"}),e(y,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(I),e(ue,{modelValue:d(h),"onUpdate:modelValue":o[4]||(o[4]=n=>U(h)?h.value=n:h=n),animated:""},{default:s(()=>[e(Q,{name:"active"},{default:s(()=>[e(L,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:q.value,columns:$.value,filter:d(_),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[e(W,{borderless:"",dense:"",debounce:"300",modelValue:d(_),"onUpdate:modelValue":o[2]||(o[2]=n=>U(_)?_.value=n:_=n),placeholder:"Search"},{append:s(()=>[e(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(n=>[i("td",ze,[e(G,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[e(z,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:H=>oe(n.row)},{default:s(()=>[e(N,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[V(" Editar ")]),_:1})]),_:2},1032,["onClick"]),e(z,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:H=>re(n.row._id)},{default:s(()=>[e(N,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[V(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(Q,{name:"inactive"},{default:s(()=>[e(L,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:M.value,columns:$.value,filter:d(_),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[e(W,{borderless:"",dense:"",debounce:"300",modelValue:d(_),"onUpdate:modelValue":o[3]||(o[3]=n=>U(_)?_.value=n:_=n),placeholder:"Search"},{append:s(()=>[e(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(n=>[i("td",Oe,[e(G,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[e(z,{"text-color":"blue-10",class:"col q-pa-none",onClick:H=>ie(n.row._id)},{default:s(()=>[Te,e(N,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[V(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),d(t).modalIsOpen?(x(),O(be,{key:0,class:"modal"},{default:s(()=>[i("div",Be,[i("h6",Re,qe(v.value),1),i("div",Fe,[i("div",$e,[e(X,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:F,value:d(S),modelValue:d(m),"onUpdate:modelValue":o[5]||(o[5]=n=>U(m)?m.value=n:m=n),onOnWrite:ee},null,8,["value","modelValue"]),e(X,{label:"Tipo de Unidad",required:!0,type:"text",ruless:F,value:d(C),modelValue:d(f),"onUpdate:modelValue":o[6]||(o[6]=n=>U(f)?f.value=n:f=n),onOnWrite:te},null,8,["value","modelValue"]),je,i("div",We,[E.value?(x(),O(Y,{key:0,disable:d(R),onOnClick:se},null,8,["disable"])):(x(),O(Y,{key:1,disable:d(R),onOnClick:le},null,8,["disable"]))]),b.value?(x(),K("div",Ge,[e(ve,{color:"primary",size:"2.5em"})])):P("",!0)])])])]),_:1})):P("",!0)],64)}}},Je=pe(Le,[["__scopeId","data-v-26939382"]]);export{Je as default};
