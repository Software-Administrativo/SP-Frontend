import{l as S,s as C,_ as _e,m as ge,q as be,g as i,v as he,f as X,x as ye,y as xe,r as d,o as V,c as Y,a as r,d as e,w as n,h as c,i as R,M as qe,j as Z,F as we,z as w,A as I,t as Ae,B as U,C as ee,p as ke,e as Ee}from"./index-2fcec7ed.js";import{B as Ve}from"./ButtonAdd-246475aa.js";const Ie=async l=>{try{const u=S(),{data:s}=await C.get("/costs/adminexpenses",{headers:{token:u,farm:l}});return s}catch(u){return u}},Se=async(l,u)=>{try{const s=S(),{data:v}=await C.post("/costs/adminexpenses/register",{name:l.name,description:l.description,worth:l.worth},{headers:{token:s,farm:u}});return v}catch(s){return s}},Ce=async(l,u)=>{try{const s=S(),{data:v}=await C.put(`/costs/adminexpenses/update/${l.id}`,{name:l.name,description:l.description,worth:l.worth},{headers:{token:s,farm:u}});return v}catch(s){return s}},Oe=async(l,u)=>{try{const s=S(),{data:v}=await C.put(`/costs/adminexpenses/inactivate/${l}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}},ze=async(l,u)=>{try{const s=S(),{data:v}=await C.put(`/costs/adminexpenses/activate/${l}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}};const F=l=>(ke("data-v-0bb23af0"),l=l(),Ee(),l),De={class:"q-py-sm table-container"},Ne={class:"row"},Te=F(()=>r("h6",{class:"title q-my-lg"},"Gastos Administrativos",-1)),Ge={class:"container-content"},Me={class:"container-table q-mt-md q-pa-md",rounded:""},Be={class:"accions-td"},Re={class:"accions-td"},Ue=F(()=>r("i",{class:"icon icon-check"},null,-1)),Fe={class:"modal-admin"},We={class:"q-my-md text-center"},je={class:"row q-px-xl"},$e={class:"col-12"},Le=F(()=>r("span",{class:"text-required q-pb-sm"},[I("Todos los campos con "),r("span",{class:"text-red"},"*"),I(" son obligatorios")],-1)),Qe={class:"row justify-center"},He={key:0,class:"spinner"},Je={__name:"AdminExpenses",setup(l){const u=ge(),s=be(),v=i(""),p=i(!1),z=i(!0),q=i([]),E=i([]),W=i(),te=he(),y=i(!1),j=X(()=>m.value==""||_.value==""||f.value==""?!0:y.value==!0),D=[t=>!!t||"Este campo es requerido"];let g=i(""),x=i("active"),m=i(""),f=i(""),_=i(""),N=i(""),T=i(""),G=i("");const $=i([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"worth",label:"Valor",field:"worth",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),ae=t=>{m.value=t},oe=t=>{f.value=t},se=t=>{_.value=t},ne=()=>{v.value="REGISTRAR GASTO ADMINISTRATIVO",le(),z.value=!0,s.toggleModal()},le=()=>{N.value="",T.value="",G.value="",m.value="",f.value="",_.value=""},ie=t=>{v.value="EDITAR GASTO ADMINISTRATIVO",z.value=!1,W.value=t._id,N.value=t.name,T.value=t.description,G.value=t.worth,m.value=t.name,f.value=t.description,_.value=t.worth,s.toggleModal()},h=(t,o)=>{u.notify({type:t,message:o,position:"top"})},A=async()=>{q.value=[],E.value=[],p.value=!0;try{const{adminExpenses:t}=await Ie(k.value);let o=1,O=1;t.forEach(b=>{b.status=b.status?"Inactivo":"Activo",b.status=="Activo"?(b.id=o++,q.value.push(b)):(b.id=O++,E.value.push(b))}),p.value=!1}catch{p.value=!1,h("negative","Ocurrió un error")}};async function re(){y.value=!0;try{const t=await Se({name:m.value,description:f.value,worth:_.value},k.value);y.value=!1,h("positive","Gasto administrativo registrado correctamente"),s.toggleModal(),q.value=[],A()}catch{y.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}}async function ce(){y.value=!0;try{const t=await Ce({id:W.value,name:m.value,description:f.value,worth:_.value},k.value);y.value=!1,h("positive","Gasto administrativo actualizado correctamente"),s.toggleModal(),q.value=[],A()}catch{y.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}m.value="",f.value="",_.value=""}async function ue(t){p.value=!0;try{const o=await ze(t,k.value);h("positive","Gasto administrativo activado correctamente"),p.value=!1,q.value=[],E.value=[],A()}catch{p.value=!1,h("negative","Ocurrió un error")}}async function de(t){p.value=!1;try{const o=await Oe(t,k.value);p.value=!1,h("positive","Gasto administrativo desactivado correctamente"),q.value=[],E.value=[],A()}catch{p.value=!1,h("negative","Ocurrió un error")}}const k=X(()=>te.idSelected);return ye(k,()=>{A()}),xe(()=>{A()}),(t,o)=>{const O=d("q-separator"),b=d("q-tab"),ve=d("q-tabs"),L=d("q-icon"),Q=d("q-input"),M=d("q-tooltip"),B=d("q-btn"),H=d("q-btn-group"),J=d("q-table"),K=d("q-tab-panel"),pe=d("q-tab-panels"),me=d("q-card"),fe=d("q-spinner-ios");return V(),Y(we,null,[r("div",De,[r("div",Ne,[r("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=a=>t.$router.back())}),Te]),e(O,{class:"separator"}),r("div",Ge,[e(Ve,{onOnClick:ne,label:"Crear nuevo gasto administrativo"}),r("div",Me,[e(me,null,{default:n(()=>[e(ve,{modelValue:c(x),"onUpdate:modelValue":o[1]||(o[1]=a=>w(x)?x.value=a:x=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[e(b,{name:"active",label:"Activos"}),e(b,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(O),e(pe,{modelValue:c(x),"onUpdate:modelValue":o[4]||(o[4]=a=>w(x)?x.value=a:x=a),animated:""},{default:n(()=>[e(K,{name:"active"},{default:n(()=>[e(J,{flat:"",bordered:"",title:"Gastos Administrativos","row-key":"name",rows:q.value,columns:$.value,filter:c(g),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[e(Q,{borderless:"",dense:"",debounce:"300",modelValue:c(g),"onUpdate:modelValue":o[2]||(o[2]=a=>w(g)?g.value=a:g=a),placeholder:"Search"},{append:n(()=>[e(L,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(a=>[r("td",Be,[e(H,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[e(B,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:P=>ie(a.row)},{default:n(()=>[e(M,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[I(" Editar ")]),_:1})]),_:2},1032,["onClick"]),e(B,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:P=>de(a.row._id)},{default:n(()=>[e(M,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[I(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(K,{name:"inactive"},{default:n(()=>[e(J,{flat:"",bordered:"",title:"Gastos Administrativos","row-key":"name",rows:E.value,columns:$.value,filter:c(g),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[e(Q,{borderless:"",dense:"",debounce:"300",modelValue:c(g),"onUpdate:modelValue":o[3]||(o[3]=a=>w(g)?g.value=a:g=a),placeholder:"Search"},{append:n(()=>[e(L,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(a=>[r("td",Re,[e(H,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[e(B,{"text-color":"blue-10",class:"col q-pa-none",onClick:P=>ue(a.row._id)},{default:n(()=>[Ue,e(M,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[I(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(s).modalIsOpen?(V(),R(qe,{key:0,class:"modal"},{default:n(()=>[r("div",Fe,[r("h6",We,Ae(v.value),1),r("div",je,[r("div",$e,[e(U,{label:"Nombre",required:!0,type:"text",ruless:D,value:c(N),modelValue:c(m),"onUpdate:modelValue":o[5]||(o[5]=a=>w(m)?m.value=a:m=a),onOnWrite:ae},null,8,["value","modelValue"]),e(U,{class:"q-mb-md",label:"Descripción",required:!0,type:"text",ruless:D,value:c(T),modelValue:c(f),"onUpdate:modelValue":o[6]||(o[6]=a=>w(f)?f.value=a:f=a),onOnWrite:oe},null,8,["value","modelValue"]),e(U,{class:"q-pb-xs",label:"Valor",required:!0,type:"text",ruless:D,value:c(G),modelValue:c(_),"onUpdate:modelValue":o[7]||(o[7]=a=>w(_)?_.value=a:_=a),onOnWrite:se},null,8,["value","modelValue"]),Le,r("div",Qe,[z.value?(V(),R(ee,{key:0,disable:c(j),onOnClick:re},null,8,["disable"])):(V(),R(ee,{key:1,disable:c(j),onOnClick:ce},null,8,["disable"]))]),y.value?(V(),Y("div",He,[e(fe,{color:"primary",size:"2.5em"})])):Z("",!0)])])])]),_:1})):Z("",!0)],64)}}},Xe=_e(Je,[["__scopeId","data-v-0bb23af0"]]);export{Xe as default};
