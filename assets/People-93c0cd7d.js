import{v as D,x as T,_ as Se,f as Ve,y as ke,g as s,z as xe,h as se,A as Ee,C as ze,r as p,o as B,c as Ae,a as c,d as l,w as r,i as u,q as j,M as Oe,l as Ie,F as Ce,a1 as W,j as w,m as C,t as De,G,k as L,B as ue,p as Te,e as Ne}from"./index-21ef78fb.js";import{B as Me}from"./ButtonAdd-adf1e21d.js";const Be=async o=>{try{const d=D(),{data:n}=await T.get("/maintenance/people",{headers:{token:d,farm:o}});return n}catch(d){return d}},Re=async(o,d)=>{try{const n=D(),{data:v}=await T.post("/maintenance/people/register",{name:o.name,tpdct:o.tpdct,document:o.document,phone:o.phone,eps:o.eps,typePeople:o.typePeople},{headers:{token:n,farm:d}});return v}catch(n){return n}},Ue=async(o,d)=>{try{const n=D(),{data:v}=await T.post(`/maintenance/people/update/${o.id}`,{name:o.name,tpdct:o.tpdct,document:o.document,phone:o.phone,eps:o.eps,typePeople:o.typePeople},{headers:{token:n,farm:d}});return v}catch(n){return n}},Fe=async(o,d)=>{try{const n=D(),{data:v}=await T.put(`/maintenance/people/inactive/${o}`,{},{headers:{token:n,farm:d}});return v}catch(n){return n}},je=async(o,d)=>{try{const n=D(),{data:v}=await T.put(`/maintenance/people/active/${o}`,{},{headers:{token:n,farm:d}});return v}catch(n){return n}};const Q=o=>(Te("data-v-f76f56ea"),o=o(),Ne(),o),We={class:"q-py-md table-container"},Ge={class:"row"},Le=Q(()=>c("h6",{class:"title q-my-lg"},"PERSONAS",-1)),Qe={class:"container-content"},$e={class:"container-table q-mt-md q-pa-md",rounded:""},He={class:"accions-td"},Je={class:"accions-td"},Ke=Q(()=>c("i",{class:"icon icon-check"},null,-1)),Xe={class:"modal-people"},Ye={class:"q-my-md text-center"},Ze={class:"row q-px-xl"},ea={class:"col-12"},aa={class:"row"},ta=Q(()=>c("span",{class:"text-required q-pb-sm"},[C("Todos los campos con "),c("span",{class:"text-red"},"*"),C(" son obligatorios")],-1)),la={class:"row justify-center"},oa={__name:"People",setup(o){const d=Ve(),n=ke(),v=s(""),R=s(!0),$=s(),re=xe(),k=s(!1),x=s([]),f=s(!1),O=s([]),H=se(()=>g.value==""||b.value==""||y.value==""||h.value==""||i.value==""||q.value==""?!0:k.value==!0),E=[e=>!!e||"Este campo es requerido"];let _=s(""),V=s("active"),g=s(""),b=s(""),y=s(""),h=s(""),i=s(""),q=s(""),J=s(""),K=s(""),X=s(""),Y=s(""),Z=s(""),ee=s("");const ae=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"document",label:"Tipo",field:"tpdct",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"document",label:"Documento",field:"document",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"phone",label:"Teléfono",field:"phone",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"eps",label:"Eps",field:"eps",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"typePeople",label:"Tipo de Persona",field:"typePeople",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),ce=e=>{g.value=e},ie=e=>{b.value=e},de=e=>{y.value=e},pe=e=>{h.value=e},ve=e=>{i.value=e},fe=e=>{q.value=e},me=()=>{v.value="REGISTRAR PERSONA",_e(),R.value=!0,n.toggleModal()},_e=()=>{g.value="",b.value="",y.value="",h.value="",i.value="",q.value=""},ge=async e=>{v.value="EDITAR PERSONA",R.value=!1,$.value=e._id,g.value=e.tpdct,J.value=e.tpdct,b.value=e.document,K.value=e.document,y.value=e.name,X.value=e.name,h.value=e.phone,Y.value=e.phone,q.value=e.typePeople,ee.value=e.typePeople,i.value=e.eps,Z.value=e.eps,n.toggleModal()},P=(e,a)=>{d.notify({type:e,message:a,position:"top"})};async function z(){x.value=[],O.value=[],f.value=!0;try{const{people:e}=await Be(S.value),{eps:a}=await W(S.value);let N=1,M=1;e.forEach(m=>{m.status=m.status?"Inactivo":"Activo";let A=m.eps;a.forEach(I=>{I._id==A&&(A=I.name)}),m.eps=A,m.status=="Activo"?(m.id=N++,x.value.push(m)):(m.id=M++,O.value.push(m))}),f.value=!1}catch{f.value=!1,P("negative","Ocurrió un error")}}async function be(){const{eps:e}=await W(S.value);e.forEach(a=>{a.name==i.value&&(i.value=a._id)}),k.value=!0;try{const a=await Re({name:y.value,tpdct:g.value,document:b.value,phone:h.value,eps:i.value,typePeople:q.value},S.value);k.value=!1,P("positive","Se registró correctamente"),n.toggleModal(),x.value=[],z()}catch{k.value=!1,P("negative","Ocurrió un error")}}async function ye(){const{eps:e}=await W(S.value);e.forEach(a=>{a.name==i.value&&(i.value=a._id)}),k.value=!0;try{const a=await Ue({id:$.value,name:y.value,tpdct:g.value,document:b.value,phone:h.value,eps:i.value,typePeople:q.value},S.value);k.value=!1,P("positive","Se actualizó correctamente"),n.toggleModal(),x.value=[],z()}catch{k.value=!1,P("negative","Ocurrió un error")}}async function he(e){f.value=!0;try{const a=await je(e,S.value);P("positive","Se activó correctamente"),f.value=!1,x.value=[],O.value=[],z()}catch{f.value=!1,P("negative","Ocurrió un error")}}async function qe(e){f.value=!0;try{const a=await Fe(e,S.value);P("positive","Se inactivó correctamente"),f.value=!1,x.value=[],O.value=[],z()}catch{f.value=!1,P("negative","Ocurrió un error")}}const S=se(()=>re.idSelected);return Ee(S,()=>{z()}),ze(()=>{z()}),(e,a)=>{const N=p("q-separator"),M=p("q-tab"),m=p("q-tabs"),A=p("q-icon"),I=p("q-input"),U=p("q-tooltip"),F=p("q-btn"),te=p("q-btn-group"),le=p("q-table"),oe=p("q-tab-panel"),we=p("q-tab-panels"),Pe=p("q-card");return B(),Ae(Ce,null,[c("div",We,[c("div",Ge,[c("i",{class:"icon icon-backRoute q-pt-lg",onClick:a[0]||(a[0]=t=>e.$router.back())}),Le]),l(N,{class:"separator"}),c("div",Qe,[l(Me,{onOnClick:me,label:"Crear nueva persona"}),c("div",$e,[l(Pe,null,{default:r(()=>[l(m,{modelValue:u(V),"onUpdate:modelValue":a[1]||(a[1]=t=>w(V)?V.value=t:V=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[l(M,{name:"active",label:"Activos"}),l(M,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(N),l(we,{modelValue:u(V),"onUpdate:modelValue":a[4]||(a[4]=t=>w(V)?V.value=t:V=t),animated:""},{default:r(()=>[l(oe,{name:"active"},{default:r(()=>[l(le,{flat:"",bordered:"",title:"Personas","row-key":"name",rows:x.value,columns:ae.value,filter:u(_),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[l(I,{borderless:"",dense:"",debounce:"300",modelValue:u(_),"onUpdate:modelValue":a[2]||(a[2]=t=>w(_)?_.value=t:_=t),placeholder:"Buscar"},{append:r(()=>[l(A,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(t=>[c("td",He,[l(te,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[l(F,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:ne=>ge(t.row)},{default:r(()=>[l(U,{class:"bg-indigo",offset:[10,10]},{default:r(()=>[C(" Editar ")]),_:1})]),_:2},1032,["onClick"]),l(F,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:ne=>qe(t.row._id)},{default:r(()=>[l(U,{class:"bg-indigo",offset:[10,10]},{default:r(()=>[C(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(oe,{name:"inactive"},{default:r(()=>[l(le,{flat:"",bordered:"",title:"Personas","row-key":"name",rows:O.value,columns:ae.value,filter:u(_),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[l(I,{borderless:"",dense:"",debounce:"300",modelValue:u(_),"onUpdate:modelValue":a[3]||(a[3]=t=>w(_)?_.value=t:_=t),placeholder:"Search"},{append:r(()=>[l(A,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(t=>[c("td",Je,[l(te,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[l(F,{"text-color":"blue-10",class:"col q-pa-none",onClick:ne=>he(t.row._id)},{default:r(()=>[Ke,l(U,{class:"bg-indigo",offset:[10,10]},{default:r(()=>[C(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),u(n).modalIsOpen?(B(),j(Oe,{key:0,class:"modal"},{default:r(()=>[c("div",Xe,[c("h6",Ye,De(v.value),1),c("div",Ze,[c("div",ea,[c("div",aa,[l(G,{class:"col-5 q-mb-lg q-pr-sm",type:"documents",label:"Tipo de Documento",ruless:E,modelValue:u(g),"onUpdate:modelValue":a[5]||(a[5]=t=>w(g)?g.value=t:g=t),value:u(J),onOnSelect:ce},null,8,["modelValue","value"]),l(L,{class:"col-7 q-pb-xs",label:"Número de Documento",required:!0,type:"number",ruless:E,value:u(K),modelValue:u(b),"onUpdate:modelValue":a[6]||(a[6]=t=>w(b)?b.value=t:b=t),onOnWrite:ie},null,8,["value","modelValue"])]),l(L,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:E,value:u(X),modelValue:u(y),"onUpdate:modelValue":a[7]||(a[7]=t=>w(y)?y.value=t:y=t),onOnWrite:de},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Teléfono",required:!0,type:"text",ruless:E,modelValue:u(h),"onUpdate:modelValue":a[8]||(a[8]=t=>w(h)?h.value=t:h=t),value:u(Y),onOnWrite:pe},null,8,["modelValue","value"]),l(G,{class:"q-pb-xs q-mb-md",label:"EPS",required:!0,ruless:E,value:u(Z),modelValue:u(i),"onUpdate:modelValue":a[9]||(a[9]=t=>w(i)?i.value=t:i=t),type:"eps",onOnSelect:ve},null,8,["value","modelValue"]),l(G,{class:"q-pb-xs",label:"Tipo de Persona",required:!0,type:"person",ruless:E,value:u(ee),modelValue:u(q),"onUpdate:modelValue":a[10]||(a[10]=t=>w(q)?q.value=t:q=t),onOnSelect:fe},null,8,["value","modelValue"]),ta,c("div",la,[R.value?(B(),j(ue,{key:0,disable:u(H),onOnClick:be},null,8,["disable"])):(B(),j(ue,{key:1,disable:u(H),onOnClick:ye},null,8,["disable"]))])])])])]),_:1})):Ie("",!0)],64)}}},ua=Se(oa,[["__scopeId","data-v-f76f56ea"]]);export{ua as default};
