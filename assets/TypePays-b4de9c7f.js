import{l as A,s as I,_ as ve,m as fe,q as _e,g as c,v as me,f as Q,x as ye,y as ge,r as d,o as T,c as H,a as r,d as e,w as n,h as p,i as B,M as be,j as J,F as he,z as P,A as V,t as qe,B as K,C as X,p as we,e as ke}from"./index-2fcec7ed.js";import{B as xe}from"./ButtonAdd-246475aa.js";const Te=async l=>{try{const i=A(),{data:a}=await I.get("/maintenance/pays",{headers:{token:i,farm:l}});return a}catch(i){return i}},Pe=async(l,i)=>{try{const a=A(),{data:v}=await I.post("/maintenance/pays/register",{name:l.name,description:l.description},{headers:{token:a,farm:i}});return v}catch(a){return a}},Ve=async(l,i)=>{try{const a=A(),{data:v}=await I.put(`/maintenance/pays/update/${l.id}`,{name:l.name,description:l.description},{headers:{token:a,farm:i}});return v}catch(a){return a}},Ae=async(l,i)=>{try{const a=A(),{data:v}=await I.put(`/maintenance/pays/inactive/${l}`,{},{headers:{token:a,farm:i}});return v}catch(a){return a}},Ie=async(l,i)=>{try{const a=A(),{data:v}=await I.put(`/maintenance/pays/active/${l}`,{},{headers:{token:a,farm:i}});return v}catch(a){return a}};const M=l=>(we("data-v-47e967ba"),l=l(),ke(),l),Oe={class:"q-py-md table-container"},Ce={class:"row"},Se=M(()=>r("h6",{class:"title q-my-lg"},"TIPOS DE PAGO",-1)),Ee={class:"container-content"},De={class:"container-table q-mt-md q-pa-md",rounded:""},ze={class:"accions-td"},Be={class:"accions-td"},Me=M(()=>r("i",{class:"icon icon-check"},null,-1)),Ne={class:"modal-pays"},Re={class:"q-my-md text-center"},Fe={class:"row q-px-xl"},Ue={class:"col-12"},$e=M(()=>r("span",{class:"text-required q-py-sm"},[V("Todos los campos con "),r("span",{class:"text-red"},"*"),V(" son obligatorios")],-1)),Ge={class:"row justify-center"},je={key:0,class:"spinner"},We={__name:"TypePays",setup(l){const i=fe(),a=_e(),v=c(""),f=c(!1),C=c(!0),h=c([]),x=c([]),N=c(),Y=me(),g=c(!1),R=Q(()=>_.value==""?!0:g.value==!0),Z=[t=>!!t||"Este campo es requerido"];let m=c(""),b=c("active"),_=c(""),q=c(""),S=c(""),E=c("");const F=c([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),ee=t=>{_.value=t},ae=t=>{q.value=t},te=()=>{v.value="REGISTRAR TIPO DE PAGO",oe(),C.value=!0,a.toggleModal()},oe=()=>{E.value="",S.value="",_.value="",q.value=""},ne=t=>{v.value="EDITAR TIPO DE PAGO",C.value=!1,N.value=t._id,E.value=t.description,S.value=t.name,_.value=t.name,q.value=t.description,a.toggleModal()},y=(t,s)=>{i.notify({type:t,message:s,position:"top"})};async function w(){h.value=[],x.value=[],f.value=!0;try{const{pays:t}=await Te(k.value);let s=1,O=1;t.forEach(u=>{u.status=u.status?"Inactivo":"Activo",u.status=="Activo"?(u.id=s++,h.value.push(u)):(u.id=O++,x.value.push(u)),u.description=u.description.trim()==""?"No registra":u.description}),f.value=!1}catch{f.value=!1,y("negative","Ocurrió un error")}}async function se(){g.value=!0;try{await Pe({name:_.value,description:q.value},k.value),g.value=!1,y("positive","Tipo de pago registrado correctamente"),a.toggleModal(),h.value=[],w()}catch{g.value=!1,y("negative","Ocurrió un error, por favor verifique los datos")}}async function le(){g.value=!0;try{await Ve({id:N.value,name:_.value,description:q.value},k.value),g.value=!1,y("positive","Tipo de pago actualizado correctamente"),a.toggleModal(),h.value=[],w()}catch{g.value=!1,y("negative","Ocurrió un error, por favor verifique los datos")}_.value="",q.value=""}async function re(t){f.value=!0;try{await Ie(t,k.value),y("positive","Tipo de pago activado correctamente"),f.value=!1,h.value=[],x.value=[],w()}catch{f.value=!1,y("negative","Ocurrió un error")}}async function ce(t){f.value=!1;try{await Ae(t,k.value),f.value=!1,y("positive","Tipo de pago desactivado correctamente"),h.value=[],x.value=[],w()}catch{f.value=!1,y("negative","Ocurrió un error")}}const k=Q(()=>Y.idSelected);return ye(k,()=>{w()}),ge(()=>{w()}),(t,s)=>{const O=d("q-separator"),u=d("q-tab"),ie=d("q-tabs"),U=d("q-icon"),$=d("q-input"),D=d("q-tooltip"),z=d("q-btn"),G=d("q-btn-group"),j=d("q-table"),W=d("q-tab-panel"),ue=d("q-tab-panels"),de=d("q-card"),pe=d("q-spinner-ios");return T(),H(he,null,[r("div",Oe,[r("div",Ce,[r("i",{class:"icon icon-backRoute q-pt-lg",onClick:s[0]||(s[0]=o=>t.$router.back())}),Se]),e(O,{class:"separator"}),r("div",Ee,[e(xe,{onOnClick:te,label:"Crear tipo de pago"}),r("div",De,[e(de,null,{default:n(()=>[e(ie,{modelValue:p(b),"onUpdate:modelValue":s[1]||(s[1]=o=>P(b)?b.value=o:b=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[e(u,{name:"active",label:"Activos"}),e(u,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(O),e(ue,{modelValue:p(b),"onUpdate:modelValue":s[4]||(s[4]=o=>P(b)?b.value=o:b=o),animated:""},{default:n(()=>[e(W,{name:"active"},{default:n(()=>[e(j,{flat:"",bordered:"",title:"Pagos","row-key":"name",rows:h.value,columns:F.value,filter:p(m),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[e($,{borderless:"",dense:"",debounce:"300",modelValue:p(m),"onUpdate:modelValue":s[2]||(s[2]=o=>P(m)?m.value=o:m=o),placeholder:"Buscar"},{append:n(()=>[e(U,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(o=>[r("td",ze,[e(G,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[e(z,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:L=>ne(o.row)},{default:n(()=>[e(D,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[V(" Editar ")]),_:1})]),_:2},1032,["onClick"]),e(z,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:L=>ce(o.row._id)},{default:n(()=>[e(D,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[V(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(W,{name:"inactive"},{default:n(()=>[e(j,{flat:"",bordered:"",title:"Pagos","row-key":"name",rows:x.value,columns:F.value,filter:p(m),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[e($,{borderless:"",dense:"",debounce:"300",modelValue:p(m),"onUpdate:modelValue":s[3]||(s[3]=o=>P(m)?m.value=o:m=o),placeholder:"Buscar"},{append:n(()=>[e(U,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(o=>[r("td",Be,[e(G,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[e(z,{"text-color":"blue-10",class:"col q-pa-none",onClick:L=>re(o.row._id)},{default:n(()=>[Me,e(D,{class:"bg-indigo",offset:[10,10]},{default:n(()=>[V(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),p(a).modalIsOpen?(T(),B(be,{key:0,class:"modal"},{default:n(()=>[r("div",Ne,[r("h6",Re,qe(v.value),1),r("div",Fe,[r("div",Ue,[e(K,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:Z,value:p(S),modelValue:p(_),"onUpdate:modelValue":s[5]||(s[5]=o=>P(_)?_.value=o:_=o),onOnWrite:ee},null,8,["value","modelValue"]),e(K,{label:"Descripción",type:"text",required:!1,value:p(E),"v-model":p(q),onOnWrite:ae},null,8,["value","v-model"]),$e,r("div",Ge,[C.value?(T(),B(X,{key:0,disable:p(R),onOnClick:se},null,8,["disable"])):(T(),B(X,{key:1,disable:p(R),onOnClick:le},null,8,["disable"]))]),g.value?(T(),H("div",je,[e(pe,{color:"primary",size:"2.5em"})])):J("",!0)])])])]),_:1})):J("",!0)],64)}}},He=ve(We,[["__scopeId","data-v-47e967ba"]]);export{He as default};
