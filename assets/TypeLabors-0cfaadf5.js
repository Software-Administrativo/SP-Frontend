import{_ as de,f as pe,y as ve,g as n,z as _e,h as W,A as fe,C as me,r as i,o as k,c as G,a as s,d as e,w as l,i as c,q as D,M as be,l as Q,F as ge,D as ye,j as q,m as T,t as qe,k as X,B as $,p as he,e as we,U as ke,V as Te,W as Ve,X as Le}from"./index-21ef78fb.js";import{B as xe}from"./ButtonAdd-adf1e21d.js";const B=V=>(he("data-v-767f6ae0"),V=V(),we(),V),Ae={class:"q-py-md table-container"},Ie={class:"row"},Oe=B(()=>s("h6",{class:"title q-my-lg"},"TIPOS DE LABOR",-1)),Se={class:"container-content"},Ce={class:"container-table q-mt-md q-pa-md",rounded:""},De={class:"accions-td"},Be={class:"accions-td"},ze=B(()=>s("i",{class:"icon icon-check"},null,-1)),Me={class:"modal-labors"},Ne={class:"q-my-md text-center"},Re={class:"row q-px-xl"},Ee={class:"col-12"},Ue=B(()=>s("span",{class:"text-required q-pb-sm"},[T("Todos los campos con "),s("span",{class:"text-red"},"*"),T(" son obligatorios")],-1)),Fe={class:"row justify-center"},je={key:0,class:"spinner"},Pe={__name:"TypeLabors",setup(V){const H=pe(),h=ve(),x=n(""),u=n(!1),A=n(!0),b=n([]),w=n([]),z=n(),J=_e(),f=n(!1),M=W(()=>d.value==""?!0:f.value==!0),K=[a=>!!a||"Este campo es requerido"];let p=n(""),m=n("active"),d=n(""),v=n(""),I=n(""),O=n("");const N=n([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Y=a=>{d.value=a},Z=a=>{v.value=a},ee=()=>{x.value="REGISTRAR TIPO DE LABOR",ae(),A.value=!0,h.toggleModal()},ae=()=>{O.value="",I.value="",d.value="",v.value=""},oe=a=>{x.value="EDITAR TIPO DE LABOR",A.value=!1,z.value=a._id,O.value=a.description,I.value=a.name,d.value=a.name,v.value=a.description,h.toggleModal()},_=(a,t)=>{H.notify({type:a,message:t,position:"top"})},g=async()=>{b.value=[],w.value=[],u.value=!0;try{const{works:a}=await ye(y.value);let t=1,L=1;a.forEach(r=>{r.status=r.status?"Inactivo":"Activo",r.status=="Activo"?(r.id=t++,b.value.push(r)):(r.id=L++,w.value.push(r)),r.description=r.description.trim()==""?"No registra":r.description}),u.value=!1}catch{u.value=!1,_("negative","Ocurrió un error")}};async function te(){f.value=!0;try{const a=await ke({name:d.value,description:v.value},y.value);f.value=!1,_("positive","Tipo de labor registrado correctamente"),h.toggleModal(),b.value=[],g()}catch{f.value=!1,_("negative","Ocurrió un error, por favor verifique los datos")}}async function le(){f.value=!0;try{const a=await Te({id:z.value,name:d.value,description:v.value},y.value);f.value=!1,_("positive","Tipo de labor actualizado correctamente"),h.toggleModal(),b.value=[],g()}catch{f.value=!1,_("negative","Ocurrió un error, por favor verifique los datos")}d.value="",v.value=""}async function se(a){u.value=!0;try{const t=await Ve(a,y.value);_("positive","Tipo de labor activado correctamente"),u.value=!1,b.value=[],w.value=[],g()}catch{u.value=!1,_("negative","Ocurrió un error")}}async function ne(a){u.value=!1;try{const t=await Le(a,y.value);u.value=!1,_("positive","Tipo de labor desactivado correctamente"),b.value=[],w.value=[],g()}catch{u.value=!1,_("negative","Ocurrió un error")}}const y=W(()=>J.idSelected);return fe(y,()=>{g()}),me(()=>{g()}),(a,t)=>{const L=i("q-separator"),r=i("q-tab"),re=i("q-tabs"),R=i("q-icon"),E=i("q-input"),S=i("q-tooltip"),C=i("q-btn"),U=i("q-btn-group"),F=i("q-table"),j=i("q-tab-panel"),ie=i("q-tab-panels"),ce=i("q-card"),ue=i("q-spinner-ios");return k(),G(ge,null,[s("div",Ae,[s("div",Ie,[s("i",{class:"icon icon-backRoute q-pt-lg",onClick:t[0]||(t[0]=o=>a.$router.back())}),Oe]),e(L,{class:"separator"}),s("div",Se,[e(xe,{onOnClick:ee,label:"Crear tipo de labor"}),s("div",Ce,[e(ce,null,{default:l(()=>[e(re,{modelValue:c(m),"onUpdate:modelValue":t[1]||(t[1]=o=>q(m)?m.value=o:m=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[e(r,{name:"active",label:"Activos"}),e(r,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(L),e(ie,{modelValue:c(m),"onUpdate:modelValue":t[4]||(t[4]=o=>q(m)?m.value=o:m=o),animated:""},{default:l(()=>[e(j,{name:"active"},{default:l(()=>[e(F,{flat:"",bordered:"",title:"Labores","row-key":"name",rows:b.value,columns:N.value,filter:c(p),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(E,{borderless:"",dense:"",debounce:"300",modelValue:c(p),"onUpdate:modelValue":t[2]||(t[2]=o=>q(p)?p.value=o:p=o),placeholder:"Search"},{append:l(()=>[e(R,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[s("td",De,[e(U,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(C,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:P=>oe(o.row)},{default:l(()=>[e(S,{class:"bg-indigo",offset:[10,10]},{default:l(()=>[T(" Editar ")]),_:1})]),_:2},1032,["onClick"]),e(C,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:P=>ne(o.row._id)},{default:l(()=>[e(S,{class:"bg-indigo",offset:[10,10]},{default:l(()=>[T(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(j,{name:"inactive"},{default:l(()=>[e(F,{flat:"",bordered:"",title:"Labores","row-key":"name",rows:w.value,columns:N.value,filter:c(p),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(E,{borderless:"",dense:"",debounce:"300",modelValue:c(p),"onUpdate:modelValue":t[3]||(t[3]=o=>q(p)?p.value=o:p=o),placeholder:"Search"},{append:l(()=>[e(R,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[s("td",Be,[e(U,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(C,{"text-color":"blue-10",class:"col q-pa-none",onClick:P=>se(o.row._id)},{default:l(()=>[ze,e(S,{class:"bg-indigo",offset:[10,10]},{default:l(()=>[T(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(h).modalIsOpen?(k(),D(be,{key:0,class:"modal"},{default:l(()=>[s("div",Me,[s("h6",Ne,qe(x.value),1),s("div",Re,[s("div",Ee,[e(X,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:K,value:c(I),modelValue:c(d),"onUpdate:modelValue":t[5]||(t[5]=o=>q(d)?d.value=o:d=o),onOnWrite:Y},null,8,["value","modelValue"]),e(X,{label:"Descripción",type:"text",required:!1,value:c(O),modelValue:c(v),"onUpdate:modelValue":t[6]||(t[6]=o=>q(v)?v.value=o:v=o),onOnWrite:Z},null,8,["value","modelValue"]),Ue,s("div",Fe,[A.value?(k(),D($,{key:0,disable:c(M),onOnClick:te},null,8,["disable"])):(k(),D($,{key:1,disable:c(M),onOnClick:le},null,8,["disable"]))]),f.value?(k(),G("div",je,[e(ue,{color:"primary",size:"2.5em"})])):Q("",!0)])])])]),_:1})):Q("",!0)],64)}}},Qe=de(Pe,[["__scopeId","data-v-767f6ae0"]]);export{Qe as default};
