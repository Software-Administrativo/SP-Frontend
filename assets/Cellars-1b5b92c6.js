import{v as A,x as B,_ as be,y as ye,g as c,z as he,h as Y,f as qe,A as we,C as Ce,r as p,o as I,c as Z,a as d,d as a,w as s,i as u,q as G,M as ke,l as ee,F as Ve,j as w,m as S,t as xe,k as D,B as te,p as Ie,e as Se}from"./index-21ef78fb.js";import{B as Ae}from"./ButtonAdd-adf1e21d.js";const Be=async o=>{try{const i=A(),{data:n}=await B.get("/inventory/cellar",{headers:{token:i,farm:o}});return n}catch(i){return i}},Oe=async(o,i)=>{try{const n=A(),{data:r}=await B.post("/inventory/cellar/register",{name:o.name,tpcontract:o.tpcontract,description:o.description,worth:o.worth},{headers:{token:n,farm:i}});return r}catch(n){return n}},ze=async(o,i)=>{try{const n=A(),{data:r}=await B.put(`/inventory/cellar/update/${o.id}`,{name:o.name,description:o.description,tpcontract:o.tpcontract,worth:o.worth},{headers:{token:n,farm:i}});return r}catch(n){return n}},De=async(o,i)=>{try{const n=A(),{data:r}=await B.put(`/inventory/cellar/inactive/${o}`,{},{headers:{token:n,farm:i}});return r}catch(n){return n}},Ee=async(o,i)=>{try{const n=A(),{data:r}=await B.put(`/inventory/cellar/activate/${o}`,{},{headers:{token:n,farm:i}});return r}catch(n){return n}};const W=o=>(Ie("data-v-5e916a1b"),o=o(),Se(),o),Ne={class:"q-py-md table-container"},Te={class:"row"},Ue=W(()=>d("h6",{class:"title q-my-lg"},"BODEGAS",-1)),Me={class:"container-content"},Re={class:"container-table q-mt-md q-pa-md",rounded:""},Fe={class:"accions-td"},Ge={class:"accions-td"},We=W(()=>d("i",{class:"icon icon-check"},null,-1)),je={class:"modal-cellars"},$e={class:"q-my-md text-center"},Le={class:"row q-px-xl"},Qe={class:"col-12"},He=W(()=>d("span",{class:"text-required q-pb-sm"},[S("Todos los campos con "),d("span",{class:"text-red"},"*"),S(" son obligatorios")],-1)),Je={class:"row justify-center"},Ke={key:0,class:"spinner"},Pe={__name:"Cellars",setup(o){const i=ye(),n=c(""),r=c(!1),E=c(!0),C=c([]),V=c([]),j=c(),ae=he(),h=c(!1),$=Y(()=>!f.value||!m.value||!b.value?!0:h.value==!0),O=[e=>!!e||"Este campo es requerido"];let _=c(""),f=c(""),m=c(""),g=c(""),b=c(""),N=c(""),T=c(""),U=c(""),M=c(""),q=c("active");const le=qe(),L=c([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"tpcontract",label:"Tipo Contrato",field:"tpcontract",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"value",label:"Valor",field:"worth",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),oe=e=>{f.value=e},ne=e=>{m.value=e},se=e=>{g.value=e},re=e=>{b.value=e},ce=()=>{n.value="REGISTRAR BODEGAS",N.value="",T.value="",U.value="",M.value="",E.value=!0,i.toggleModal(),f.value="",m.value="",g.value="",b.value=""},ie=e=>{n.value="EDITAR BODEGAS",E.value=!1,j.value=e._id,N.value=e.name,T.value=e.tpcontract,U.value=e.description,M.value=e.worth,f.value=e.name,m.value=e.tpcontract,g.value=e.description,b.value=e.worth,i.toggleModal()},y=(e,l)=>{le.notify({type:e,message:l,position:"top"})},x=async()=>{C.value=[],V.value=[],r.value=!0;try{const{cellar:e}=await Be(k.value);let l=1,z=1;e.forEach(v=>{v.status=v.status?"Inactivo":"Activo",v.status=="Activo"?(v.id=l++,C.value.push(v)):(v.id=z++,V.value.push(v)),v.description=v.description.trim()==""?"No registra":v.description}),r.value=!1}catch{y("negative","Ocurrió un error")}};async function ue(){h.value=!0;try{const e=await Oe({name:f.value,tpcontract:m.value,description:g.value,worth:b.value},k.value);h.value=!1,r.value=!1,y("positive","Bodega registrada correctamente"),i.toggleModal(),C.value=[],x()}catch{h.value=!1,y("negative","Ocurrió un error")}}async function de(){h.value=!0;try{const e=await ze({id:j.value,name:f.value,tpcontract:m.value,description:g.value,worth:b.value},k.value);h.value=!1,y("positive","Bodega actualizada correctamente"),i.toggleModal(),C.value=[],x()}catch{h.value=!1,y("negative","Ocurrió un error")}f.value="",g.value=""}async function ve(e){r.value=!0;try{const l=await Ee(e,k.value);y("positive","Bodega activada correctamente"),r.value=!1,C.value=[],V.value=[],x()}catch{r.value=!1,y("negative","Ocurrió un error")}}async function pe(e){r.value=!0;try{const l=await De(e,k.value);y("positive","Bodega desactivada correctamente"),r.value=!1,C.value=[],V.value=[],x()}catch{r.value=!1,y("negative","Ocurrió un error")}}const k=Y(()=>ae.idSelected);return we(k,()=>{getDataUsers()}),Ce(()=>{x()}),(e,l)=>{const z=p("q-separator"),v=p("q-tab"),fe=p("q-tabs"),Q=p("q-icon"),H=p("q-input"),R=p("q-tooltip"),F=p("q-btn"),J=p("q-btn-group"),K=p("q-table"),P=p("q-tab-panel"),_e=p("q-tab-panels"),me=p("q-card"),ge=p("q-spinner-ios");return I(),Z(Ve,null,[d("div",Ne,[d("div",Te,[d("i",{class:"icon icon-backRoute q-pt-lg",onClick:l[0]||(l[0]=t=>e.$router.back())}),Ue]),a(z,{class:"separator"}),d("div",Me,[a(Ae,{onOnClick:ce,label:"Crear nueva bodega"}),d("div",Re,[a(me,null,{default:s(()=>[a(fe,{modelValue:u(q),"onUpdate:modelValue":l[1]||(l[1]=t=>w(q)?q.value=t:q=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:s(()=>[a(v,{name:"active",label:"Activos"}),a(v,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),a(z),a(_e,{modelValue:u(q),"onUpdate:modelValue":l[4]||(l[4]=t=>w(q)?q.value=t:q=t),animated:""},{default:s(()=>[a(P,{name:"active"},{default:s(()=>[a(K,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:C.value,columns:L.value,filter:u(_),loading:r.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[a(H,{borderless:"",dense:"",debounce:"300",modelValue:u(_),"onUpdate:modelValue":l[2]||(l[2]=t=>w(_)?_.value=t:_=t),placeholder:"Search"},{append:s(()=>[a(Q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(t=>[d("td",Fe,[a(J,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[a(F,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:X=>ie(t.row)},{default:s(()=>[a(R,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[S(" Editar ")]),_:1})]),_:2},1032,["onClick"]),a(F,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:X=>pe(t.row._id)},{default:s(()=>[a(R,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[S(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),a(P,{name:"inactive"},{default:s(()=>[a(K,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:V.value,columns:L.value,filter:u(_),loading:r.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[a(H,{borderless:"",dense:"",debounce:"300",modelValue:u(_),"onUpdate:modelValue":l[3]||(l[3]=t=>w(_)?_.value=t:_=t),placeholder:"Search"},{append:s(()=>[a(Q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(t=>[d("td",Ge,[a(J,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[a(F,{"text-color":"blue-10",class:"col q-pa-none",onClick:X=>ve(t.row._id)},{default:s(()=>[We,a(R,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[S(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),u(i).modalIsOpen?(I(),G(ke,{key:0,class:"modal"},{default:s(()=>[d("div",je,[d("h6",$e,xe(n.value),1),d("div",Le,[d("div",Qe,[a(D,{label:"Nombre",required:!0,type:"text",ruless:O,value:u(N),modelValue:u(f),"onUpdate:modelValue":l[5]||(l[5]=t=>w(f)?f.value=t:f=t),onOnWrite:oe},null,8,["value","modelValue"]),a(D,{class:"q-pb-xs",label:"Tipo Contrato",required:!0,type:"text",ruless:O,value:u(T),modelValue:u(m),"onUpdate:modelValue":l[6]||(l[6]=t=>w(m)?m.value=t:m=t),onOnWrite:ne},null,8,["value","modelValue"]),a(D,{label:"Descripción",type:"text",required:!0,ruless:O,value:u(U),modelValue:u(g),"onUpdate:modelValue":l[7]||(l[7]=t=>w(g)?g.value=t:g=t),onOnWrite:se},null,8,["value","modelValue"]),a(D,{class:"q-pb-xs",label:"Valor",required:!0,type:"number",ruless:O,value:u(M),modelValue:u(b),"onUpdate:modelValue":l[8]||(l[8]=t=>w(b)?b.value=t:b=t),onOnWrite:re},null,8,["value","modelValue"]),He,d("div",Je,[E.value?(I(),G(te,{key:0,disable:u($),onOnClick:ue},null,8,["disable"])):(I(),G(te,{key:1,disable:u($),onOnClick:de},null,8,["disable"]))]),h.value?(I(),Z("div",Ke,[a(ge,{color:"primary",size:"2.5em"})])):ee("",!0)])])])]),_:1})):ee("",!0)],64)}}},Ze=be(Pe,[["__scopeId","data-v-5e916a1b"]]);export{Ze as default};
